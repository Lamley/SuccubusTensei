;────────────────────────────────────
;愛撫、性交等の継続、解除、処理
;────────────────────────────────────
@SHOW_TOUCH
;(1=ペニス 2=クリトリス 3=指 4=口 5=胸 6=膣 7=アナル 8=足)
FOR LOCAL,1,CHARANUM
	SIF TARGET:LOCAL <= 0
		CONTINUE
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ｐ接触部位
		CASE 3
			PRINT 手淫 
		CASE 4
			PRINT 舐陰茎 
		CASE 6
			PRINT 逆強姦 
		CASE 7
			PRINT 逆アナル 
		CASE 8
			PRINT 足交 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ｃ接触部位
		CASE 1
			PRINT 素股 
		CASE 3
			PRINT 陰蒂愛撫 
		CASE 4
			PRINT 舐陰 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):指接触部位
		CASE 1
			PRINT 手淫 
		CASE 5
			PRINT 揉胸あい 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):口接触部位
		CASE 1
			PRINT フェラ 
		CASE 2
			PRINT 舐陰させる 
		CASE 4
			PRINT キス 
		CASE 7
			PRINT 肛門奉仕 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ｂ接触部位
		CASE 1
			PRINT 乳交 
		CASE 3
			PRINT 胸愛撫 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ｖ接触部位
		CASE 1
			PRINT 性交 
		CASE 3
			PRINT 指入れ 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ａ接触部位
		CASE 1
			PRINT 肛門セックス 
		CASE 3
			PRINT 肛門愛撫 
		CASE 4
			PRINT 肛門舐め 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):足接触部位
		CASE 1
			PRINT 足交 
	ENDSELECT
	PRINTFORML (%CALLNAME:(TARGET:LOCAL)%)
NEXT
PRINTL

@TOUCH_SUCCESSION(ARG)
VARSET LOCAL
SELECTCASE SELECTCOM
	;愛撫　指と口をリセット
	CASE 0
		CALL TOUCH_RESET_M(SET_YUBI)
		SIF !TEQUIP:ARG:継続キス
			CALL TOUCH_RESET_M(SET_M)
		;本来は二箇所同時だけど、システム的には一箇所しか無理なので、苦肉の策
		IF !RAND:2
			CALL TOUCH_SET(SET_FROM_C,SET_YUBI,ARG)
		ELSE
			CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
		ENDIF
	;舐陰　性交解除し対象のＣに口をセット
	CASE 1
		CALL 挿入解除(ARG)
		CALL TOUCH_RESET_M(SET_YUBI)
		IF GETBIT(TALENT:ARG:性別,1)
			CALL TOUCH_SET(SET_FROM_P,SET_M,ARG)
		ELSE
			CALL TOUCH_SET(SET_FROM_C,SET_M,ARG)
		ENDIF
	;舐陰茎　性交解除し対象のＣに口をセット
	CASE 2
		;性交解除
		CALL 挿入解除(ARG)
		CALL TOUCH_SET(SET_FROM_P,SET_M,ARG)
	;手指挿入
	CASE 3
		IF TEQUIP:ARG:振動棒
		;指リセット
			CALL TOUCH_RESET_M(SET_YUBI)
		ELSE
			;指を対象のＶにセット
			CALL TOUCH_SET(SET_FROM_V,SET_YUBI,ARG)
		ENDIF
	;舐肛
	CASE 4
		;性交解除し口を対象のＡにセット
		CALL 挿入解除(ARG)
		CALL TOUCH_RESET_M(SET_YUBI)
		CALL TOUCH_SET(SET_FROM_A,SET_M,ARG)
	;肛門愛撫
	CASE 5
		IF TEQUIP:ARG:肛用振動棒 || TEQUIP:ARG:後庭拉珠 || TEQUIP:ARG:浣腸
			;指リセット
			CALL TOUCH_RESET_M(SET_YUBI)
		ELSE
			CALL TOUCH_SET(SET_FROM_A,SET_YUBI,ARG)
		ENDIF
	;胸愛撫
	CASE 6
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;玩弄乳頭
	CASE 7
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;張開陰唇
	CASE 8
		IF TEQUIP:ARG:Ａ接触部位 == 1 && TEQUIP:ARG:体位 == 2
			TEQUIP:ARG:体位 = 1
		ELSEIF TEQUIP:ARG:Ａ接触部位 == 1 && TEQUIP:ARG:体位 == 5
			TEQUIP:ARG:体位 = 4
		ELSEIF !TEQUIP:ARG:Ａ接触部位 == 1
			CALL TOUCH_RESET_T(ARG)
		ENDIF
	;自慰
	CASE 9
	;乳首吸い
	CASE 10
		CALL TOUCH_SET(SET_FROM_B,SET_M,ARG)
;--------------------------------------
	CASE 11
		CALL TOUCH_SET(SET_FROM_B,SET_M,ARG)
;--------------------------------------
	;揉胸
	CASE 12
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;張開肛門
	CASE 13
		IF TEQUIP:ARG:Ｖ接触部位 == 1 && TEQUIP:ARG:体位 == 1
			TEQUIP:ARG:体位 = 2
		ELSEIF TEQUIP:ARG:Ｖ接触部位 == 1 && TEQUIP:ARG:体位 == 4
			TEQUIP:ARG:体位 = 5
		ELSEIF !TEQUIP:ARG:Ｖ接触部位 == 1
			CALL TOUCH_RESET_T(ARG)
		ENDIF
	;接吻
	CASE 19,20
		CALL TOUCH_SET(SET_FROM_M,SET_M,ARG)
	;跳蛋
	CASE 40
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｐ接触部位 = 0
	;電動按摩棒
	CASE 41
		CALL TOUCH_SET(0,0,0,SET_P)
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｐ接触部位 = 0
	;陰蒂夾
	CASE 42
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｐ接触部位 = 0
	;飛機杯
	CASE 43
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｐ接触部位 = 0
	;振動棒
	CASE 44
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｖ接触部位 = 0
	;肛用振動棒
	CASE 45
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ａ接触部位 = 0
	;後庭拉珠
	CASE 46
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ａ接触部位 = 0
	;乳頭夾
	CASE 47
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｂ接触部位 = 0
	;搾乳機
	CASE 48
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｂ接触部位 = 0
	;乳頭跳蛋
	CASE 49
		CALL TOUCH_RESET_M(SET_YUBI)
	;正常位
	CASE 60
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 1
	;後背位
	CASE 61
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 2
	;正常位肛交
	CASE 62
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 1
	;後背位肛交
	CASE 63, 323
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 2
	;逆強姦
	CASE 64
		CALL TOUCH_SET(SET_FROM_P,SET_V,ARG,1)
		TEQUIP:ARG:体位 = 3
	;騎乗位
	CASE 65
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 3
	;騎乗位肛交
	CASE 66
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 3
	;対面座位
	CASE 67
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 4
	;背面座位
	CASE 68
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
		TEQUIP:ARG:体位 = 5
	;対面座位肛交
	CASE 69
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 4
	;背面座位肛交
	CASE 70
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
		TEQUIP:ARG:体位 = 5
	;二穴挿入
	CASE 71
		IF TEQUIP:ARG:Ｖ接触部位 == 1
			TEQUIP:ARG:Ａ接触部位 = 0
		ELSEIF TEQUIP:ARG:Ａ接触部位 == 1
			TEQUIP:ARG:Ｖ接触部位 = 0
		ENDIF
	;挿入Ｇ点玩弄
	CASE 72
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG)
	;挿入子宮
	CASE 73
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG)
	;玩弄Ｓ状結腸
	CASE 74
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG)
	;ＡＧスポ
	CASE 75
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG)
	;小人飛機杯
	CASE 79
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 6
	;手淫
	CASE 80
		CALL TOUCH_SET(SET_FROM_YUBI,SET_P,ARG)
	;口交
	CASE 81
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 挿入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_M,SET_P,ARG)
	;乳交
	CASE 82
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 挿入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_B,SET_P,ARG)
	;素股
	CASE 83
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 挿入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_C,SET_P,ARG)
	;泡泡浴
	CASE 84
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 挿入解除(ARG)
		ENDIF
		CALL TOUCH_SET(0,0,0,1)
	;真空口交
	CASE 88
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 挿入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_M,SET_P,ARG)
	;被愛撫肛門
	CASE 90
		CALL TOUCH_SET(SET_FROM_YUBI,SET_A,ARG)
	;被舐肛門
	CASE 91
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 挿入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_M,SET_A,ARG)
	;被Ａ正常位
	CASE 92
		CALL TOUCH_SET(SET_FROM_P,SET_A,ARG)
		TEQUIP:MASTER:体位 = 1
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｖ接触部位 = 0
	;被Ａ後背位
	CASE 93
		CALL TOUCH_SET(SET_FROM_P,SET_A,ARG)
		TEQUIP:MASTER:体位 = 2
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｖ接触部位 = 0
	;Ａ騎乗位
	CASE 94
		CALL TOUCH_SET(SET_FROM_P,SET_A,ARG)
		TEQUIP:MASTER:体位 = 3
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｖ接触部位 = 0
	;打屁股
	CASE 100
		CALL TOUCH_RESET_M(SET_YUBI)
	;鞭
	CASE 101
		CALL TOUCH_RESET_M(SET_YUBI)
	;蝋燭
	CASE 102
		CALL TOUCH_RESET_M(SET_YUBI)
	;針
	CASE 103
		CALL TOUCH_RESET_M(SET_YUBI)
	;眼罩
	CASE 104
		CALL TOUCH_RESET_M(SET_YUBI)
	;打胸部
	CASE 108
		CALL TOUCH_RESET_M(SET_YUBI)
	;強制舐陰
	CASE 120
		CALL TOUCH_SET(SET_FROM_M,SET_C,ARG)
	;磨鏡
	CASE 121
		CALL TOUCH_SET(SET_FROM_C,SET_C,ARG)
	;手淫
	CASE 124
		CALL TOUCH_SET(SET_FROM_P,SET_YUBI,ARG)
	;被愛撫
	CASE 125
		TEQUIP:ARG:指接触部位 = 0
		TEQUIP:ARG:口接触部位 = 0
	;互揉胸部
	CASE 126
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:指接触部位 = 0
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
		CALL TOUCH_SET(SET_FROM_YUBI,5,ARG)
	;強制口交
	CASE 140
		CALL TOUCH_SET(SET_FROM_M,SET_P,ARG)
	;拳交
	CASE 141
		CALL TOUCH_SET(SET_FROM_V,SET_YUBI,ARG)
	;肛門拳交
	CASE 142
		CALL TOUCH_SET(SET_FROM_A,SET_YUBI,ARG)
	;両穴拳交
	CASE 143
		TEQUIP:MASTER:Ｖ接触部位 = 3
		TEQUIP:MASTER:Ａ接触部位 = 3
	;肛門奉仕
	CASE 145
		CALL TOUCH_SET(SET_FROM_M,SET_A,ARG)
	;浣腸
	CASE 146
		CALL TOUCH_RESET_M(SET_YUBI)
	;拡張気球
	CASE 147
		CALL TOUCH_RESET_M(SET_YUBI)
	;肛門電極
	CASE 148
		CALL TOUCH_RESET_M(SET_YUBI)
		CALL TOUCH_SET(SET_FROM_A,1,ARG)
	;乳を握り潰す
	CASE 149
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;双乳間抽插
	CASE 150
		CALL TOUCH_SET(SET_FROM_B,SET_P,ARG)

	;日常セクハラ
	;接吻
	CASE 312
		CALL TOUCH_SET(SET_FROM_M,SET_M,ARG)
	;胸愛撫
	CASE 313
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;肛門愛撫
	CASE 314
		CALL TOUCH_SET(SET_FROM_A,SET_YUBI,ARG)
	;陰蒂愛撫
	CASE 315
		IF GETBIT(TALENT:ARG:性別,1)
			CALL TOUCH_SET(SET_FROM_P,SET_YUBI,ARG)
		ELSE
			CALL TOUCH_SET(SET_FROM_C,SET_YUBI,ARG)
		ENDIF
	;手指挿入
	CASE 316
		CALL TOUCH_SET(SET_FROM_V,SET_YUBI,ARG)

	;相手主導正常位
	CASE 320
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 挿入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 1
	;相手主導後背位
	CASE 322
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 挿入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 2
	;相手主導後背位Ａ
	CASE 323
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 挿入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 2
	
	;愛撫(慰)
	CASE 700
		CALL TOUCH_RESET_M(SET_YUBI)
	;セルフフェラ(慰)
	CASE 702
		TEQUIP:MASTER:口接触部位 = 1
		TEQUIP:MASTER:Ｐ接触部位 = 4
	;手指挿入(慰)
	CASE 703
		IF TEQUIP:ARG:振動棒
		;指リセット
			CALL TOUCH_RESET_M(SET_YUBI)
		ELSE
			;指を対象のＶにセット
			CALL TOUCH_SET(SET_FROM_V,SET_YUBI,MASTER)
		ENDIF
	;肛門愛撫(慰)
	CASE 705
		IF TEQUIP:ARG:肛用振動棒 || TEQUIP:ARG:後庭拉珠 || TEQUIP:ARG:浣腸
			;指リセット
			CALL TOUCH_RESET_M(SET_YUBI)
		ELSE
			CALL TOUCH_SET(SET_FROM_A,SET_YUBI,MASTER)
		ENDIF
	;胸愛撫(慰)
	CASE 706
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,MASTER)
	;玩弄乳頭(慰)
	CASE 707
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,MASTER)
	;張開陰唇(慰)
	CASE 708
		CALL TOUCH_RESET_T(MASTER)
	;手淫(慰)
	CASE 709
		CALL TOUCH_SET(SET_FROM_P,SET_YUBI,MASTER)
	;揉胸(慰)
	CASE 712
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,MASTER)
	;張開肛門(慰)
	CASE 713
		CALL TOUCH_RESET_T(MASTER)
	;跳蛋(慰)
	CASE 740
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｃ接触部位 = 0
		TEQUIP:MASTER:Ｐ接触部位 = 0
	;電動按摩棒(慰)
	CASE 741
		CALL TOUCH_SET(0,0,0,1)
		TEQUIP:MASTER:Ｃ接触部位 = 0
		TEQUIP:MASTER:Ｐ接触部位 = 0
	;陰蒂夾(慰)
	CASE 742
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｃ接触部位 = 0
		TEQUIP:MASTER:Ｐ接触部位 = 0
	;飛機杯(慰)
	CASE 743
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｃ接触部位 = 0
		TEQUIP:MASTER:Ｐ接触部位 = 0
	;振動棒(慰)
	CASE 744
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｖ接触部位 = 0
	;肛用振動棒(慰)
	CASE 745
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ａ接触部位 = 0
	;後庭拉珠(慰)
	CASE 746
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ａ接触部位 = 0
	;乳頭夾(慰)
	CASE 747
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｂ接触部位 = 0
	;搾乳機(慰)
	CASE 748
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｂ接触部位 = 0
	;乳頭跳蛋(慰)
	CASE 749

	CASE IS < 200
		CALL TOUCH_SET(0,0,0,1)
	CASE IS > 500
		CALL TOUCH_SET(0,0,0,1)
	;掃除
	CASE 410
		CALL TOUCH_SET(0,0,0,1)
ENDSELECT


;MASTERとTARGETの接触部位を設定する
@TOUCH_SET(ARG,ARG:1,ARG:2,ARG:3)
;ARG TARGETの接触部位(101=ペニス 102=クリトリス 103=指 104=口 105=胸 106=膣 107=アナル 108=足)
;ARG:1 MASTERの接触部位(1=ペニス 2=クリトリス 3=指 4=口 5=胸 6=膣 7=アナル 8=足)
;ARG:2 対象のキャラ番号
;ARG:3 真ならリセットする
VARSET LOCAL

IF ARG:3
	FOR LOCAL,1,CHARANUM
		FOR LOCAL:1,1,9
			TEQUIP:LOCAL:(100 + LOCAL:1) = 0
		NEXT
		;ついでに体位もリセット
		TEQUIP:LOCAL:体位 = 0
	NEXT
ENDIF
SIF ARG <= 100
	RETURN 0
FOR LOCAL,1,CHARANUM
	FOR LOCAL:1,1,9
		SIF TEQUIP:LOCAL:(100 + LOCAL:1) == ARG:1
			TEQUIP:LOCAL:(100 + LOCAL:1) = 0
	NEXT
NEXT
TEQUIP:(ARG:2):ARG = ARG:1
;継続系コマンドを解除

IF MASTER_POSE(SET_M,SET_M) != ARG:2 && TEQUIP:(ARG:2):継続キス && SELECTCOM != 0
	FOR LOCAL,1,CHARANUM
		TEQUIP:LOCAL:継続キス = 0
	NEXT
	PRINTL ＜接吻解除＞
ENDIF

IF MASTER_POSE(SET_B,SET_YUBI) != ARG:2 && TEQUIP:(ARG:2):揉胸
	FOR LOCAL,1,CHARANUM
		TEQUIP:LOCAL:揉胸 = 0
	NEXT
	PRINTL ＜揉胸解除＞
ENDIF

IF MASTER_POSE(SET_B,SET_M) != ARG:2 && TEQUIP:(ARG:2):乳首吸い && SELECTCOM != 6 && SELECTCOM != 12
	FOR LOCAL,1,CHARANUM
		TEQUIP:LOCAL:乳首吸い = 0
	NEXT
	PRINTL ＜吸乳头解除＞
ENDIF


;MASTERの接触部位をリセットする
@TOUCH_RESET_M(ARG)
;ARG MASTERの接触部位(1=ペニス 2=クリトリス 3=指 4=口 5=胸 6=膣 7=アナル 8=足)
FOR LOCAL,1,CHARANUM
	SIF TARGET:LOCAL <= 0
		CONTINUE
	FOR LOCAL:1,1,9
		SIF TEQUIP:(TARGET:LOCAL):(100 + LOCAL:1) == ARG
				TEQUIP:(TARGET:LOCAL):(100 + LOCAL:1) = 0
	NEXT
NEXT

;TARGETの接触部位をリセットする
@TOUCH_RESET_T(ARG)
FOR LOCAL,1,9
	TEQUIP:ARG:(100 + LOCAL) = 0
NEXT

@MASTER_POSE(ARG,ARG:1,ARG:2)
;ARG MASTERの部位を占有中のTARGET:Xの部位(1=ペニス 2=クリトリス 3=指 4=口 5=胸 6=膣 7=アナル 8=足)
;ARG 0なら誰が占有しているか返す
;ARG:1 MASTERの部位(1=ペニス 2=クリトリス 3=指 4=口 5=胸 6=膣 7=アナル 8=足)
;ARG:2 真なら前ターンの履歴を見る
;戻り値 MASTERの部位を占有中のTARGET:Xがいるならそのキャラ番号を返す
;MASTER_POSE(SET_M,SET_P,1)なら前ターン(第3引数)に誰かがMASTERのペニス(第2引数)を口(第1引数)で占有していた場合、そのキャラ番号を返す
;ARGでMASTERのARG:1に触れているキャラを返すってこと
#FUNCTION
VARSET LOCAL
IF !ARG
	FOR LOCAL,1,CHARANUM
		SIF CFLAG:LOCAL:現在位置 != CFLAG:MASTER:現在位置
			CONTINUE
		FOR LOCAL:1,1,9
			SIF TEQUIP:LOCAL:(100 + LOCAL:1) == ARG:1
				RETURNF LOCAL
		NEXT
	NEXT
ENDIF
ARG:2 = ARG:2 ? 1 # 0
FOR LOCAL,1,CHARANUM
	SIF TARGET:LOCAL <= 0
		CONTINUE
	SIF TEQUIP:(TARGET:LOCAL):(100 + ARG + 10 * ARG:2) == ARG:1
		RETURNF TARGET:LOCAL
NEXT

@挿入解除(ARG)
SIF TEQUIP:ARG:Ｖ接触部位 == 1
	TEQUIP:ARG:Ｖ接触部位 = 0
SIF TEQUIP:ARG:Ａ接触部位 == 1
	TEQUIP:ARG:Ａ接触部位 = 0
TEQUIP:ARG:Ｃ接触部位 = 0
TEQUIP:ARG:Ｐ接触部位 = 0
TEQUIP:ARG:口接触部位 = 0
TEQUIP:ARG:Ｖセックス = -1
TEQUIP:ARG:Ａセックス = -1
TEQUIP:ARG:体位 = 0