;--------------------------------------------------
;	マップ内移動処理拡張パッチ付属
;		地底MAP用関数
;--------------------------------------------------
@MAP_PLACENAME_9(ARG)
#FUNCTIONS
#DIM PLACEID
IF GET_MAPID(ARG) == MAIN_MAP
	SELECTCASE ARG
		CASE 901 TO (MAXROOM - 1)
			RETURNF STR:(ARG + 8000)
		CASE 998
			RETURNF OMANEKI_PLACE()
		CASE 999
			RETURNF "隙間空間"
		CASE MAXROOM
			RETURNF "地上"
		CASEELSE
			RETURNF "不明"
	ENDSELECT
ELSE
	RETURNF "不明"
ENDIF

;@MAP_VIEWING_9
;
;SIF CHK_FOCUS(927,CFLAG:MASTER:現在位置,930)
;	CALL MAP_OLD_HELL
;SIF CHK_FOCUS(902,CFLAG:MASTER:現在位置,926)
;	CALL MAP_TIREIDEN
;SIF (CFLAG:MASTER:現在位置 == 901) || CHK_FOCUS(931,CFLAG:MASTER:現在位置,948)
;	CALL MAP_OLD_CITY
;RETURN 1

@MAP_VIEWING_9(AA)
#DIMS REF AA, 0
IF !TFLAG:マップ切り替え
	IF CHK_FOCUS(927,CFLAG:MASTER:現在位置,930)
		TFLAG:マップ切り替え = 3
	ELSEIF (CFLAG:MASTER:現在位置 == 901) || CHK_FOCUS(931,CFLAG:MASTER:現在位置,948)
		TFLAG:マップ切り替え = 2
	ELSE
		TFLAG:マップ切り替え = 1
	ENDIF
ENDIF
CALL DRAW_INFORMATIONLINE(@"%MAPNAME:(TFLAG:マップ切り替え)%")
PRINTFORML 
TRYCALLFORM MAP_CHIREIDEN_{TFLAG:マップ切り替え}(AA)


@MAP_CAN_MOVE_9(ARG, ARG:1)
#FUNCTION
SELECTCASE ARG
	;旧西樓梯、東樓梯、噴水、地蔵
	CASE 907, 908, 924, 947
		RETURNF 0
	;情人旅館,主人公以外は入らない
	CASE 935
		SIF ARG:1 != MASTER
			RETURNF 0
	CASEELSE
		RETURNF 1
ENDSELECT

@MAP_CANNOT_WORD_9(ARG)
PRINTW 工事中
CLEARLINE 2
REUSELASTLINE 
RETURN
