@COM_ABLE2820(ARG)
VARSET LOCAL
LOCAL = ARG
;;;VARSET ARG
;;;SIF LOCAL == MASTER
;;;	RETURN 0
RETURN 1

@COM2820(ARG,ARG:1)
;行為
VARSET LOCAL
VARSET LOCAL:2
VARSET LOCAL:3
VARSET LOCAL:4
IF ARG:1
	FOR LOCAL,2060,2200
		SIF LOCAL > 2079 && LOCAL < 2099 && LOCAL != 2199
			CONTINUE
;;;强奸の場合は女性はぺ二番装着と仮定（未実装だが）のでGETBIT(TALENT:XXX:2,1)は判定しない
		IF !GETBIT(TALENT:(TCVAR:ARG:行為対象):2,0)
			SIF LOCAL == 2060
				CONTINUE
			SIF LOCAL == 2061
				CONTINUE
			SIF LOCAL == 2065
				CONTINUE
			SIF LOCAL == 2067
				CONTINUE
			SIF LOCAL == 2068
				CONTINUE
		ENDIF
		IF !GETBIT(TALENT:ARG:2,0)
			SIF LOCAL == 2100
				CONTINUE
			SIF LOCAL == 2101
				CONTINUE
			SIF LOCAL == 2105
				CONTINUE
			SIF LOCAL == 2107
				CONTINUE
			SIF LOCAL == 2108
				CONTINUE
		ENDIF
		IF !GETBIT(TALENT:ARG:2,0) || !GETBIT(TALENT:(TCVAR:ARG:行為対象):2,0)
			SIF LOCAL == 2071
				CONTINUE
		ENDIF
		SIF TRAINNAME:LOCAL == ""
			CONTINUE
		LOCAL:1 = RAND(100)
		IF LOCAL:2 < LOCAL:1
			LOCAL:2 = LOCAL:1
			LOCAL:3 = LOCAL
			LOCAL:4++
		ENDIF
	NEXT
ELSE
	FOR LOCAL,2001,2200
		SIF TRAINNAME:LOCAL == ""
			CONTINUE
		TRYCCALLFORM COM_ABLE{LOCAL}(H)
		IF RESULT
			SIF LOCAL > 2099 && LOCAL != 2199
				CONTINUE
			LOCAL:1 = RAND(100)
			IF LOCAL:2 < LOCAL:1
				LOCAL:2 = LOCAL:1
				LOCAL:3 = LOCAL
				LOCAL:4++
			ENDIF
		ENDIF
		CATCH
			PRINTVL LOCAL
		ENDCATCH
	NEXT
ENDIF
STR:0 = % "COM" + TOSTR(LOCAL:3) %
IF LOCAL:4
	CALLFORM %STR:0%(H)
ELSE
	CALL COM2199(H)
ENDIF

RETURN 1

