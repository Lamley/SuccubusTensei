@COM_ABLE1048(ARG)
VARSET LOCAL
LOCAL = ARG
VARSET ARG
;薬をもっていないと実行不可
SIF !(HAVE_DRUGS(LOCAL))
	RETURN 0
RETURN GLOBAL_COMABLE(1048)


@COM1048(ARG)
;薬を飲む
VARSET LOCAL
PRINTL 
PRINTFORML %"=" * 107%

DRAWLINE
PRINTFORML どの薬を飲みますか？
FOR LOCAL,150,175
SIF EQUIP:ARG:LOCAL
	PRINTFORML [{LOCAL,3}] - %ITEMNAME:LOCAL% 残り{EQUIP:ARG:LOCAL}個
NEXT
	PRINTFORML [999] - やめる
$INPUT_LOOP
INPUT

LOCAL:1 = RESULT
IF RESULT == 150 && EQUIP:ARG:(LOCAL:1)
	;春药
	TEQUIP:ARG:春药 += 120
ELSEIF RESULT == 151 && EQUIP:ARG:(LOCAL:1)
	;利尿剂
	TEQUIP:ARG:利尿剂 += 120
ELSEIF RESULT == 152 && EQUIP:ARG:(LOCAL:1)
	;栄養ドリンク
	DOWNBASE:ARG:体力 -= 800 / (1 + TEQUIP:ARG:栄養ドリンク / 250)
	TEQUIP:ARG:栄養ドリンク += 300
ELSEIF RESULT == 153 && EQUIP:ARG:(LOCAL:1)
	;眠気心灵感知まし
	BASE:ARG:眠気 = LIMIT(BASE:ARG:眠気 - 1000,0,MAXBASE:ARG:眠気)
	TEQUIP:ARG:眠気心灵感知まし += 120
ELSEIF RESULT == 154 && EQUIP:ARG:(LOCAL:1)
	;アロマスプレー
	TEQUIP:ARG:アロマスプレー += 120
ELSEIF RESULT == 174 && EQUIP:ARG:(LOCAL:1)
	;下剤
	TEQUIP:ARG:下剤 += 120
ELSEIF RESULT == 155 && EQUIP:ARG:(LOCAL:1)
	;睡眠薬
	TEQUIP:ARG:睡眠薬 += 120
ELSEIF RESULT == 999
	;止める
	RETURN 0
ELSE
	CLEARLINE 1
	GOTO INPUT_LOOP
ENDIF
PRINTFORMW %ITEMNAME:(LOCAL:1)%を使いました
EQUIP:ARG:(LOCAL:1)--
CFLAG:ARG:待機時間 = 1
RETURN 1


@HAVE_DRUGS(ARG)
;薬をもっているかどうかを判定する関数
;クスリ……クスリをちょうだい……
#FUNCTION
FOR LOCAL,150,175
SIF EQUIP:ARG:LOCAL
	RETURNF 1
NEXT
RETURNF 0
