@SHOW_USERCOM

	
@USERCOM


@PLAYER_USERCOM
VARSET LOCAL
CALL SHOW_STATUS
FOR LOCAL,0,2000
	SIF TRAINNAME:LOCAL == ""
		CONTINUE
	SIF LOCAL == 1000
		PRINTL 
	TRYCCALLFORM COM_ABLE{LOCAL}(MASTER)
	IF RESULT
		PRINTFORMC %TRAINNAME:LOCAL%[{LOCAL,4}]
	ENDIF
	CATCH
	ENDCATCH
NEXT
PRINTL 
PRINTC 能力表示[1900]
	
SIF !TCVAR:MASTER:イベント
	PRINTC 换衣服[1901]
IF !TCVAR:MASTER:イベント && TFLAG:同室
	PRINTC 强奸[2700]
	PRINTC 战斗[2750]
ENDIF
PRINTC 調教菜單登録[990]
	PRINTL
	IF FLAG:550 > 0
		PRINTC 調教菜單表示[991]
		PRINTC 調教菜單実行[992]
	ENDIF
SIF !TCVAR:MASTER:イベント && N:101 > 0
	PRINTC 和附近的人闲谈[2850]
PRINTC ロード[3000]
$INPUT_LOOP
INPUT

IF RESULT == 990
	CALL COMSEQ_REGISTER
	RESTART
ELSEIF RESULT == 991 && FLAG:550 > 0 
	CALL COMSEQ_SHOW
	WAIT
	RESTART
ELSEIF RESULT == 992 && FLAG:550 > 0 
	CALL COMSEQ_TRAIN
ENDIF
IF RESULT == 1900
	CALL SHOW_CHARADATA
	RESTART
ELSEIF RESULT == 1901 && !TCVAR:MASTER:イベント
	CALL CHANGE_CLOTHES(MASTER)
	RESTART
ELSEIF RESULT == 2700 && !TCVAR:MASTER:イベント && TFLAG:同室
	SELECTCOM:MASTER = RESULT
	TRYCCALLFORM COM_ABLE{SELECTCOM:MASTER}(MASTER)
	IF RESULT
		CALLFORM COM{SELECTCOM:MASTER}(MASTER)
		SIF !RESULT
			RESTART
	ELSE
		CLEARLINE 1
		GOTO INPUT_LOOP
	ENDIF
	CATCH
		CLEARLINE 1
		GOTO INPUT_LOOP
	ENDCATCH
ELSEIF RESULT == 2750 && !TCVAR:MASTER:イベント && TFLAG:同室
	SELECTCOM:MASTER = RESULT
	TRYCCALLFORM COM_ABLE{SELECTCOM:MASTER}(MASTER)
	IF RESULT
		CALLFORM COM{SELECTCOM:MASTER}(MASTER)
		SIF !RESULT
			RESTART
	ELSE
		CLEARLINE 1
		GOTO INPUT_LOOP
	ENDIF
	CATCH
		CLEARLINE 1
		GOTO INPUT_LOOP
	ENDCATCH
ELSEIF RESULT == 2850 && !TCVAR:MASTER:イベント
	SELECTCOM:MASTER = RESULT
	TRYCCALLFORM COM_ABLE{SELECTCOM:MASTER}(MASTER)
	IF RESULT
		CALLFORM COM{SELECTCOM:MASTER}(MASTER)
		SIF !RESULT
			RESTART
	ELSE
		CLEARLINE 1
		GOTO INPUT_LOOP
	ENDIF
	CATCH
		CLEARLINE 1
		GOTO INPUT_LOOP
	ENDCATCH
ELSEIF RESULT > 2000 && GETCHARA(RESULT - 2000) != -1 && TCVAR:(RESULT - 2000):行為対象 == MASTER
	TARGET = RESULT - 2000
	TCVAR:MASTER:行為対象 = TARGET
	RESTART
	;TCVAR:(TCVAR:MASTER:行為対象):攻め受け = 2
ELSEIF RESULT == 3000
	PRINTL 何番をロードしますか？
	FOR LOCAL,0,20
		CHKDATA LOCAL
		PRINTFORML [{LOCAL,2}] \@ RESULT == 0?%RESULTS%# ----\@
	NEXT
	CHKDATA 99
	PRINTFORML [99] \@ RESULT == 0?%RESULTS%# ----\@
	PRINTL [100] 戻る
	$INPUT_LOOP2
	INPUT
	IF RESULT == 100
		RESTART
	ELSEIF (RESULT >= 0 && RESULT < 20) || RESULT == 99
		LOCAL:1 = RESULT
		CHKDATA LOCAL:1
		IF RESULT == 0
			LOADDATA LOCAL:1
		ELSE
			CLEARLINE 1
			GOTO INPUT_LOOP2
		ENDIF
	ELSE
		CLEARLINE 1
		GOTO INPUT_LOOP2
	ENDIF
	RESTART
ELSEIF RESULT < 0 || RESULT > 2000 || TRAINNAME:LOCAL != ""
	CLEARLINE 1
	GOTO INPUT_LOOP
ELSE
	SELECTCOM:MASTER = RESULT
	TRYCCALLFORM COM_ABLE{SELECTCOM:MASTER}(MASTER)
	IF RESULT
		CALLFORM COM{SELECTCOM:MASTER}(MASTER)
		SIF !RESULT
			RESTART
	ELSE
		CLEARLINE 1
		GOTO INPUT_LOOP
	ENDIF
	CATCH
		CLEARLINE 1
		GOTO INPUT_LOOP
	ENDCATCH
ENDIF


