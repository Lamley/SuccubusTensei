@NPC_ENKOU(ARG,ARG:1)
I:16 = (BASE:(ARG:1):刺激度 * 2) + BASE:(ARG:1):容姿
IF ARG:1 == 1
	SELECTCASE I:16
		CASE IS < 900
			IF RAND(10) < 2
			ELSE
				RETURN 1
			ENDIF
		CASE 900 TO 1000
			IF RAND(10) < 3
			ELSE
				RETURN 1
			ENDIF
		CASEELSE
			IF RAND(10) < 4
			ELSE
				RETURN 1
			ENDIF
	ENDSELECT
	PRINTFORM 打工结束后%PLACE_NAME(CFLAG:(ARG:1):現在地区,CFLAG:(ARG:1):現在位置)%的女主人
IF RAND:4 == 1
	PRINTFORM 抚摸着%CALLNAME:(ARG:1)%的阴
ELSEIF RAND:3 == 1
	PRINTFORM 揽着%CALLNAME:(ARG:1)%的肩
ELSEIF RAND:2 == 1
	PRINTFORM 搂着%CALLNAME:(ARG:1)%的手臂
ELSE
	PRINTFORM 从后面抱住%CALLNAME:(ARG:1)%
ENDIF
	PRINTFORML 邀请进行援交
	PRINTL 怎么办呢？
	PRINTFORML [0] - 好吧
	PRINTFORML [1] - 拒绝
$INPUT_LOOP1
	INPUT
	SIF RESULT != 0 && RESULT != 1
		GOTO INPUT_LOOP1
	IF RESULT == 1
		PRINTFORML %CALLNAME:(ARG:1)%拒绝了
		TB:(CFLAG:(ARG:1):現在地区):(CFLAG:(ARG:1):現在位置):(ARG:1) -= 1
		RETURN 1
	ENDIF
ELSE
	SELECTCASE I:16
;;;違和感ありますが、1,2=处女、0=童貞なので
		CASE IS < 900
			IF RAND(10) == 0 && ((!TALENT:(ARG:1):处女 && GETBIT(TALENT:(ARG:1):2,0)) || (TALENT:(ARG:1):童貞 && GETBIT(TALENT:(ARG:1):2,1)))
			ELSE
				RETURN 1
			ENDIF
		CASE 900 TO 1000
			IF RAND(10) < 2 && ((!TALENT:(ARG:1):处女 && GETBIT(TALENT:(ARG:1):2,0)) || (TALENT:(ARG:1):童貞 && GETBIT(TALENT:(ARG:1):2,1)))
			ELSEIF RAND(10) < 1
			ELSE
				RETURN 1
			ENDIF
		CASEELSE
			IF RAND(10) < 4 && ((!TALENT:(ARG:1):处女 && GETBIT(TALENT:(ARG:1):2,0)) || (TALENT:(ARG:1):童貞 && GETBIT(TALENT:(ARG:1):2,1)))
			ELSEIF RAND(10) < 2
			ELSE
				RETURN 1
			ENDIF
	ENDSELECT
	SETCOLOR 0xFF0000
	PRINTFORMW %CALLNAME:(ARG:1)%和%PLACE_NAME(CFLAG:(ARG:1):現在地区,CFLAG:(ARG:1):現在位置)%的女主人援交了。
	RESETCOLOR
	PRINTFORML [0] - 確認
	INPUT
ENDIF
CFLAG:(ARG:1):現在地区 = 2
CFLAG:(ARG:1):現在位置 = 22
TCVAR:(ARG:1):目的位置 = 0
TCVAR:(ARG:1):目的地区 = 0
I:15 = CFLAG:(ARG:1):待機時間
CFLAG:(ARG:1):待機時間 = 0
I:13 = TCVAR:MASTER:イベント
TCVAR:MASTER:イベント = 0
IF TCVAR:MASTER:行為対象
	I:14 = TCVAR:(TCVAR:MASTER:行為対象):イベント
	TCVAR:(TCVAR:MASTER:行為対象):イベント = 0
ENDIF
J:116 = 1
TFLAG:Ｎイベント = 8
TFLAG:行為者 = ARG
FOR G,0,5
	TCVAR:ARG:行為対象 = ARG:1
	TCVAR:(ARG:1):行為対象 = ARG
	CFLAG:ARG:受能動 = 1
	CFLAG:(ARG:1):受能動 = 2
;Hはコマンド実行時のARG変数に代入
	H = ARG
	CALL COM2820(ARG,0)
	TCVAR:ARG:行為対象 = ARG:1
	CALL SOURCE_CHECKS(ARG)
	TFLAG:行為者 = ARG
	SIF ARG:1 == 1
		PRINTW
NEXT
TEQUIP:(ARG:1):膣 = 0
TEQUIP:(ARG:1):アナル = 0
FOR G,0,10
	TCVAR:ARG:行為対象 = ARG:1
	TCVAR:(ARG:1):行為対象 = ARG
	CFLAG:ARG:受能動 = 1
	CFLAG:(ARG:1):受能動 = 2
;Hはコマンド実行時のARG変数に代入
	H = ARG
	CALL COM2820(ARG,1)
	TCVAR:ARG:行為対象 = ARG:1
	CALL SOURCE_CHECKS(ARG)
	TFLAG:行為者 = ARG
	SIF ARG:1 == 1
		PRINTW
NEXT
PRINTFORMW %CALLNAME:ARG%　→　%CALLNAME:(ARG:1)%　行為終了
TCVAR:MASTER:イベント = I:13
IF TCVAR:MASTER:行為対象
	TCVAR:(TCVAR:MASTER:行為対象):イベント = I:14
ENDIF
CFLAG:(ARG:1):会话 = 1
CALL EVENT_ESCAPE_NPC(ARG,ARG:1)
TFLAG:Ｎイベント = 0
J:116 = 0
CFLAG:(ARG:1):待機時間 = I:15
CFLAG:(ARG:1):待機時間 += 90
MONEY:(ARG:1) += 20000
BASE:(ARG:1):評判 -= 70
TB:(CFLAG:(ARG:1):現在地区):(CFLAG:(ARG:1):現在位置):(ARG:1) -= 3

@NANPA1
IF CFLAG:1:現在位置 == 3 && BASE:1:評判 >= 700
	I = 0
J:102 = RAND(CHARANUM - 2)
J:102 += 2
		IF TALENT:(J:102):ナンパ == 0
;		PRINTFORMW %CALLNAME:(J:102)%试图搭讪
			RETURN 1
		ELSEIF TA:(J:102):1:4 <= 100
;		PRINTFORMW %CALLNAME:(J:102)%不想和%CALLNAME:1%做
			RETURN 1
		ENDIF
		I = J:102
	IF MONEY:I >= 7000
		CALLFORM NANPA(I,1)
		J:118 = RESULT
		SIF J:118 == 2
			RETURN 3
	ELSE
;		PRINTFORMW %CALLNAME:I%因为缺钱而放弃了搭讪
	ENDIF
ENDIF
@NANPA(ARG,ARG:1)
;;;ナンパ（死語？）されるということ

I:16 = (BASE:(ARG:1):刺激度 * 2) + (BASE:(ARG:1):容姿 * 3)

IF ARG:1 == 1
	SELECTCASE I:16
		CASE IS < 900
			IF RAND(10) < 3
			ELSE
				RETURN 1
			ENDIF
		CASE 900 TO 1000
			IF RAND(10) < 5
			ELSE
				RETURN 1
			ENDIF
		CASEELSE
			IF RAND(10) < 6
			ELSE
				RETURN 1
			ENDIF
	ENDSELECT
	PRINT うろうろしてると
	PRINTFORML %CALLNAME:ARG%靠近过来、「不做点好事情么？」被邀请了
	PRINTL 怎么办？
	PRINTFORML [0] - -同意
	PRINTFORML [1] - 只是喝茶的话就行
	PRINTFORML [2] - 拒绝
$INPUT_LOOP1
	INPUT
	SIF RESULT != 0 && RESULT != 1 && RESULT != 2
		GOTO INPUT_LOOP1
	I:17 = 0
	IF RESULT == 1
		I:17 = 1
	ELSEIF RESULT == 2
			PRINTFORML %CALLNAME:(ARG:1)%は断った。
			TB:(CFLAG:(ARG:1):現在地区):(CFLAG:(ARG:1):現在位置):(ARG:1) -= 1
			RETURN 1
	ENDIF
ELSE
IF TALENT:(ARG:1):2 == 2 && TALENT:(ARG):2 == 2
;		PRINTFORMW %CALLNAME:(ARG:1)%和%CALLNAME:ARG%遇见了
		RETURN 1
ENDIF
	SELECTCASE I:16
;;;違和感ありますが、1,2=处女、0=童貞なので
		CASE IS < 900
			IF RAND(10) == 0 && ((!TALENT:(ARG:1):处女 && GETBIT(TALENT:(ARG:1):2,0)) || (TALENT:(ARG:1):童貞 && GETBIT(TALENT:(ARG:1):2,1)))
			ELSE
				RETURN 1
			ENDIF
		CASE 900 TO 1000
			IF RAND(10) < 2 && ((!TALENT:(ARG:1):处女 && GETBIT(TALENT:(ARG:1):2,0)) || (TALENT:(ARG:1):童貞 && GETBIT(TALENT:(ARG:1):2,1)))
			ELSEIF RAND(10) < 1
			ELSE
				RETURN 1
			ENDIF
		CASEELSE
			IF RAND(10) < 4 && ((!TALENT:(ARG:1):处女 && GETBIT(TALENT:(ARG:1):2,0)) || (TALENT:(ARG:1):童貞 && GETBIT(TALENT:(ARG:1):2,1)))
			ELSEIF RAND(10) < 2
			ELSE
				RETURN 1
			ENDIF
	ENDSELECT
	I:17 = 0
	IF RAND(3) == 0
		SETCOLOR 0xFF0000
		PRINTFORMW %CALLNAME:(ARG:1)%对%CALLNAME:ARG%泡妞成功。
		RESETCOLOR
		PRINTFORML [0] - 確認
		INPUT
	ELSE
		I:17 = 1
	ENDIF
ENDIF
IF I:17
	IF CFLAG:(ARG:1):現在地区 == 0
		CFLAG:(ARG:1):現在位置 = 6
	ELSE
		CFLAG:(ARG:1):現在地区 = 2
		CFLAG:(ARG:1):現在位置 = 14
	ENDIF
	IF ARG:1 == 1
		PRINTFORMW %CALLNAME:(ARG:1)%和%CALLNAME:ARG%在%PLACE_NAME(CFLAG:(ARG:1):現在地区,CFLAG:(ARG:1):現在位置)%喝了茶。
		IF RAND(10) < 2
			PRINTFORMW 被下药带进了酒店。
			GOTO INPUT_LOOP3
		ENDIF
	ENDIF
	TCVAR:(ARG:1):目的位置 = 0
	TCVAR:(ARG:1):目的地区 = 0
	I:15 = CFLAG:(ARG:1):待機時間
	CFLAG:(ARG:1):待機時間 = 0
	I:13 = TCVAR:MASTER:イベント
	TCVAR:MASTER:イベント = 0
	IF TCVAR:MASTER:行為対象
		I:14 = TCVAR:(TCVAR:MASTER:行為対象):イベント
		TCVAR:(TCVAR:MASTER:行為対象):イベント = 0
	ENDIF
	CFLAG:ARG:受能動 = 1
	CFLAG:(ARG:1):受能動 = 2
	TCVAR:ARG:行為対象 = ARG:1
	TCVAR:(ARG:1):行為対象 = ARG
	CALL COM2800(ARG)
	TCVAR:ARG:行為対象 = ARG:1
	TCVAR:(ARG:1):行為対象 = ARG
	CALL SOURCE_CHECKS(ARG)
	IF TFLAG:成否用変数 > -2
		TFLAG:行為者 = (ARG:1)
		CFLAG:ARG:受能動 = 2
		CFLAG:(ARG:1):受能動 = 1
		TCVAR:ARG:行為対象 = (ARG:1)
		TCVAR:(ARG:1):行為対象 = ARG
		CALL COM2801(ARG:1)
		TCVAR:(ARG:1):行為対象 = ARG
		TCVAR:ARG:行為対象 = (ARG:1)
		CALL SOURCE_CHECKS(ARG:1)
		TFLAG:行為者 = ARG
		MAXBASE:ARG:气力 += 1
		MAXBASE:(ARG:1):气力 += 1
		TA:(ARG:1):ARG:4 += 5
		TA:ARG:(ARG:1):4 += 5
		TA:(ARG:1):ARG:5 += 5
		TA:ARG:(ARG:1):5 += 5
		TA:(ARG:1):ARG:6 -= 10
		TA:ARG:(ARG:1):6 -= 10
	ENDIF
	CFLAG:(ARG:1):会话 = 1
	CALL EVENT_ESCAPE_NPC(ARG,ARG:1)
	TFLAG:Ｎイベント = 0
	TCVAR:MASTER:イベント = I:13
	IF TCVAR:MASTER:行為対象
		TCVAR:(TCVAR:MASTER:行為対象):イベント = I:14
	ENDIF
	CFLAG:(ARG:1):待機時間 = I:15
	CFLAG:(ARG:1):待機時間 += 30
	MONEY:ARG -= 1000
	TB:(CFLAG:(ARG:1):現在地区):(CFLAG:(ARG:1):現在位置):ARG += 1
	TB:(CFLAG:(ARG:1):現在地区):(CFLAG:(ARG:1):現在位置):(ARG:1) += 1
ELSE
$INPUT_LOOP3
	IF CFLAG:(ARG:1):現在地区 == 0
		CFLAG:(ARG:1):現在位置 = 11
	ELSE
		CFLAG:(ARG:1):現在地区 = 2
		CFLAG:(ARG:1):現在位置 = 22
	ENDIF
	SIF ARG:1 == 1
		PRINTFORMW %PLACE_NAME(CFLAG:(ARG:1):現在地区,CFLAG:(ARG:1):現在位置)%带我去了。
	TCVAR:(ARG:1):目的位置 = 0
	TCVAR:(ARG:1):目的地区 = 0
	I:15 = CFLAG:(ARG:1):待機時間
	CFLAG:(ARG:1):待機時間 = 0
	I:13 = TCVAR:MASTER:イベント
	TCVAR:MASTER:イベント = 0
	IF TCVAR:MASTER:行為対象
		I:14 = TCVAR:(TCVAR:MASTER:行為対象):イベント
		TCVAR:(TCVAR:MASTER:行為対象):イベント = 0
	ENDIF
	TFLAG:Ｎイベント = 8
	TFLAG:行為者 = ARG
	FOR G,0,5
		TCVAR:ARG:行為対象 = ARG:1
		TCVAR:(ARG:1):行為対象 = ARG
		CFLAG:ARG:受能動 = 1
		CFLAG:(ARG:1):受能動 = 2
;Hはコマンド実行時のARG変数に代入
		H = ARG
		CALL COM2820(ARG,0)
		TCVAR:ARG:行為対象 = ARG:1
		CALL SOURCE_CHECKS(ARG)
		TFLAG:行為者 = ARG
		SIF ARG:1 == 1
			PRINTW
	NEXT
	TEQUIP:(ARG:1):膣 = 0
	TEQUIP:(ARG:1):アナル = 0
	FOR G,0,10
		TCVAR:ARG:行為対象 = ARG:1
		TCVAR:(ARG:1):行為対象 = ARG
		CFLAG:ARG:受能動 = 1
		CFLAG:(ARG:1):受能動 = 2
;Hはコマンド実行時のARG変数に代入
		H = ARG
		CALL COM2820(ARG,1)
		TCVAR:ARG:行為対象 = ARG:1
		CALL SOURCE_CHECKS(ARG)
		TFLAG:行為者 = ARG
		SIF ARG:1 == 1
			PRINTW
	NEXT
	PRINTFORMW %CALLNAME:ARG%　→　%CALLNAME:(ARG:1)%　行為終了
	TCVAR:MASTER:イベント = I:13
	IF TCVAR:MASTER:行為対象
		TCVAR:(TCVAR:MASTER:行為対象):イベント = I:14
	ENDIF
	CFLAG:(ARG:1):会话 = 1
	CALL EVENT_ESCAPE_NPC(ARG,ARG:1)
	CFLAG:(ARG:1):待機時間 = I:15
	CFLAG:(ARG:1):待機時間 += 90
	SIF CFLAG:(ARG:1):現在地区 == 2
		MONEY:ARG -= 7000
	MAXBASE:ARG:体力 += 5
	MAXBASE:ARG:气力 += 5
	MAXBASE:(ARG:1):体力 += 5
	MAXBASE:(ARG:1):气力 += 5
	TA:(ARG:1):ARG:6 -= 10
	TA:ARG:(ARG:1):6 -= 10
	TB:(CFLAG:(ARG:1):現在地区):(CFLAG:(ARG:1):現在位置):ARG += 2
	TB:(CFLAG:(ARG:1):現在地区):(CFLAG:(ARG:1):現在位置):(ARG:1) -= 2
	BASE:ARG:評判 -= 20
	BASE:(ARG:1):評判 -= 100
	TFLAG:Ｎイベント = 0
ENDIF
RETURN 2

