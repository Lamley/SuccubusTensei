;非TARGET依存性SOURCE

@SOURCE_EXP(ARG)
VARSET LOCAL
SIF SOURCE:ARG:快Ｃ
	EXP:ARG:0 ++
SIF SOURCE:ARG:快Ｖ && (!TCVAR:ARG:破瓜抑制 || !TALENT:ARG:处女)
	EXP:ARG:1 ++
SIF SOURCE:ARG:快Ａ
	EXP:ARG:2 ++
SIF SOURCE:ARG:快Ｂ
	EXP:ARG:3 ++
SIF TCVAR:ARG:イベント == 1 && !(SELECTCOM >= 900 && SELECTCOM < 1000)
	EXP:ARG:痴汉经验++
@SOURCE_快Ｃ(ARG)
VARSET LOCAL
;Ｃ敏感とＣ钝感はここで処理
SOURCE:ARG:快Ｃ = SOURCE:ARG:快Ｃ * (2 + TALENT:ARG:Ｃ感度) / 2

;C感心灵感知
SOURCE:ARG:快Ｃ = SOURCE:ARG:快Ｃ * SOURCE_REVISION1(ABL:ARG:Ｃ感觉) / 10

LOCAL = SOURCE:ARG:快Ｃ
;PALAM:情欲をみる
IF PALAM:ARG:情欲 < PALAMLV:1
	TIMES LOCAL , 0.80
ELSEIF PALAM:ARG:情欲 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:情欲 < PALAMLV:3
	TIMES LOCAL , 1.20
ELSEIF PALAM:ARG:情欲 < PALAMLV:4
	TIMES LOCAL , 1.40
ELSEIF PALAM:ARG:情欲 >= PALAMLV:4
	TIMES LOCAL , 1.60
ENDIF
CUP:ARG:快Ｃ += LOCAL

LOCAL = SOURCE:ARG:快Ｃ
;ABL:欲望をみる
LOCAL = LOCAL * SOURCE_REVISION2(ABL:ARG:欲望) / 100

CUP:ARG:情欲 += LOCAL


@SOURCE_快Ｖ(ARG)
VARSET LOCAL
;Ｖ敏感とＶ钝感はここで処理
SOURCE:ARG:快Ｖ = SOURCE:ARG:快Ｖ * (2 + TALENT:ARG:Ｖ感度) / 2

;V感心灵感知
SOURCE:ARG:快Ｖ = SOURCE:ARG:快Ｖ * SOURCE_REVISION1(ABL:ARG:Ｖ感觉) / 10
;EXP:Ｖ经验をみる
IF EXP:ARG:Ｖ经验 < EXPLV:1
	TIMES SOURCE:ARG:快Ｖ , 0.30
ELSEIF EXP:ARG:Ｖ经验 < EXPLV:2
	TIMES SOURCE:ARG:快Ｖ , 0.50
ELSEIF EXP:ARG:Ｖ经验 < EXPLV:3
	TIMES SOURCE:ARG:快Ｖ , 0.80
ELSEIF EXP:ARG:Ｖ经验 < EXPLV:4
	TIMES SOURCE:ARG:快Ｖ , 1.00
ELSEIF EXP:ARG:Ｖ经验 < EXPLV:5
	TIMES SOURCE:ARG:快Ｖ , 1.20
ELSEIF EXP:ARG:Ｖ经验 >= EXPLV:5
	TIMES SOURCE:ARG:快Ｖ , 1.50
ENDIF

;PALAM:润滑をみる
IF PALAM:ARG:润滑 < PALAMLV:1
	TIMES SOURCE:ARG:快Ｖ , 0.10
ELSEIF PALAM:ARG:润滑 < PALAMLV:2
	TIMES SOURCE:ARG:快Ｖ , 0.40
ELSEIF PALAM:ARG:润滑 < PALAMLV:3
	TIMES SOURCE:ARG:快Ｖ , 0.60
ELSEIF PALAM:ARG:润滑 < PALAMLV:4
	TIMES SOURCE:ARG:快Ｖ , 0.80
ELSEIF PALAM:ARG:润滑 >= PALAMLV:4
	TIMES SOURCE:ARG:快Ｖ , 1.00
ENDIF

LOCAL = SOURCE:ARG:快Ｖ
LOCAL:1 = SOURCE:ARG:快Ｖ

;PALAM:情欲をみる
IF PALAM:ARG:情欲 < PALAMLV:1
	TIMES LOCAL , 0.60
ELSEIF PALAM:ARG:情欲 < PALAMLV:2
	TIMES LOCAL , 0.80
ELSEIF PALAM:ARG:情欲 < PALAMLV:3
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:情欲 < PALAMLV:4
	TIMES LOCAL , 1.20
ELSEIF PALAM:ARG:情欲 >= PALAMLV:4
	TIMES LOCAL , 1.50
ENDIF

;ABL:欲望をみる
LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:ARG:欲望) / 100

;小人体型
IF TALENT:ARG:体型 < -2
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.20
ENDIF

CUP:ARG:快Ｖ += LOCAL
CUP:ARG:情欲 += LOCAL:1

@SOURCE_快Ａ(ARG)
VARSET LOCAL

;Ａ敏感とＡ钝感はここで処理
SOURCE:ARG:快Ａ = SOURCE:ARG:快Ａ * (2 + TALENT:ARG:Ａ感度) / 2

;A感心灵感知
SOURCE:ARG:快Ａ = SOURCE:ARG:快Ａ * SOURCE_REVISION1(ABL:ARG:Ａ感觉) / 10
;EXP:Ａ经验をみる
IF EXP:ARG:Ａ经验 < EXPLV:1
	TIMES SOURCE:ARG:快Ａ , 0.30
ELSEIF EXP:ARG:Ａ经验 < EXPLV:2
	TIMES SOURCE:ARG:快Ａ , 0.50
ELSEIF EXP:ARG:Ａ经验 < EXPLV:3
	TIMES SOURCE:ARG:快Ａ , 0.80
ELSEIF EXP:ARG:Ａ经验 < EXPLV:4
	TIMES SOURCE:ARG:快Ａ , 1.00
ELSEIF EXP:ARG:Ａ经验 < EXPLV:5
	TIMES SOURCE:ARG:快Ａ , 1.20
ELSEIF EXP:ARG:Ａ经验 >= EXPLV:5
	TIMES SOURCE:ARG:快Ａ , 1.50
ENDIF

;PALAM:润滑をみる
IF PALAM:ARG:润滑 < PALAMLV:1
	TIMES SOURCE:ARG:快Ａ , 0.40
ELSEIF PALAM:ARG:润滑 < PALAMLV:2
	TIMES SOURCE:ARG:快Ａ , 0.60
ELSEIF PALAM:ARG:润滑 < PALAMLV:3
	TIMES SOURCE:ARG:快Ａ , 0.80
ELSEIF PALAM:ARG:润滑 < PALAMLV:4
	TIMES SOURCE:ARG:快Ａ , 0.90
ELSEIF PALAM:ARG:润滑 >= PALAMLV:4
	TIMES SOURCE:ARG:快Ａ , 1.00
ENDIF

LOCAL = SOURCE:ARG:快Ａ
LOCAL:1 = SOURCE:ARG:快Ａ

;PALAM:情欲をみる
;快ＡはあまりPALAM:情欲では差が出ない
IF PALAM:ARG:情欲 < PALAMLV:1
	TIMES LOCAL , 0.90
ELSEIF PALAM:ARG:情欲 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:情欲 < PALAMLV:3
	TIMES LOCAL , 1.10
ELSEIF PALAM:ARG:情欲 < PALAMLV:4
	TIMES LOCAL , 1.20
ELSEIF PALAM:ARG:情欲 >= PALAMLV:4
	TIMES LOCAL , 1.30
ENDIF

;ABL:欲望をみる
LOCAL:1 = LOCAL:1 * SOURCE_REVISION2(ABL:ARG:欲望) / 100

;小人体型
IF TALENT:ARG:体型 < -2
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 1.50
ENDIF

;快Aのソースが0以上で处女で贞操重视のとき、屈服のソースを三分の一にする
IF EXP:ARG:Ｖ经验 == 0 && TALENT:ARG:貞操 > 0 && SOURCE:ARG:快Ａ > 0
	SOURCE:ARG:屈従 /= 3
ENDIF

CUP:ARG:快Ａ += LOCAL
CUP:ARG:情欲 += LOCAL:1

@SOURCE_快Ｂ(ARG)
VARSET LOCAL
;Ｂ敏感とＢ钝感はここで処理
SOURCE:ARG:快Ｂ = SOURCE:ARG:快Ｂ * (2 + TALENT:ARG:Ｂ感度) / 2

;B感心灵感知
SOURCE:ARG:快Ｂ = SOURCE:ARG:快Ｂ * SOURCE_REVISION1(ABL:ARG:Ｂ感觉) / 10

LOCAL = SOURCE:ARG:快Ｂ

;PALAM:情欲をみる
IF PALAM:ARG:情欲 < PALAMLV:1
	TIMES LOCAL , 0.80
ELSEIF PALAM:ARG:情欲 < PALAMLV:2
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:情欲 < PALAMLV:3
	TIMES LOCAL , 1.20
ELSEIF PALAM:ARG:情欲 < PALAMLV:4
	TIMES LOCAL , 1.40
ELSEIF PALAM:ARG:情欲 >= PALAMLV:4
	TIMES LOCAL , 1.60
ENDIF

CUP:ARG:快Ｂ += LOCAL

LOCAL = SOURCE:ARG:快Ｂ
;ABL:欲望をみる
LOCAL = LOCAL * SOURCE_REVISION2(ABL:ARG:欲望) / 100

CUP:ARG:情欲 += LOCAL


@SOURCE_CVAB_EXTRA(ARG)
VARSET LOCAL
;-------------------------------------------------
;气力０による上下の処理（快楽系）
;-------------------------------------------------
IF BASE:ARG:气力 <= 0
	;UP:0,1,2,3は絶頂に絡むので先に処理する
	CUP:ARG:快Ｃ /= 2
	CUP:ARG:快Ｖ /= 2
	CUP:ARG:快Ａ /= 2
	CUP:ARG:快Ｂ /= 2
ENDIF
;-------------------------------------------------
;相性による上下の処理（快楽系）
;-------------------------------------------------
IF TCVAR:ARG:行為対象 && RELATION:ARG:(TCVAR:ARG:行為対象) != 0
	CUP:ARG:快Ｃ *= RELATION:ARG:(TCVAR:ARG:行為対象)
	CUP:ARG:快Ｃ /= 100
	CUP:ARG:快Ｖ *= RELATION:ARG:(TCVAR:ARG:行為対象)
	CUP:ARG:快Ｖ /= 100
	CUP:ARG:快Ａ *= RELATION:ARG:(TCVAR:ARG:行為対象)
	CUP:ARG:快Ａ /= 100
	CUP:ARG:快Ｂ *= RELATION:ARG:(TCVAR:ARG:行為対象)
	CUP:ARG:快Ｂ /= 100
ENDIF
;-------------------------------------------------
;否定快感は、快ソースの数値に応じて、抑郁増加（淫乱で無効）
;-------------------------------------------------
SIF TALENT:ARG:快感応答 < 0 && !TALENT:ARG:淫乱
	SOURCE:ARG:鬱屈 += (CUP:ARG:快Ｃ + CUP:ARG:快Ｖ + CUP:ARG:快Ａ + CUP:ARG:快Ｂ)/10

;-------------------------------------------------
;素質などによる上下の処理（快楽系）
;-------------------------------------------------
;春药
IF TEQUIP:ARG:春药
	TIMES CUP:ARG:快Ｃ , 2.00
	TIMES CUP:ARG:快Ｖ , 2.00
	TIMES CUP:ARG:快Ａ , 2.00
	TIMES CUP:ARG:快Ｂ , 2.00
ENDIF
	;利尿剂
IF TEQUIP:ARG:利尿剂
	TIMES CUP:ARG:快Ｃ , 0.70
	TIMES CUP:ARG:快Ｖ , 0.70
	TIMES CUP:ARG:快Ａ , 0.70
	TIMES CUP:ARG:快Ｂ , 0.70
ENDIF
;-------------------------------------------------
;陥落素質
;-------------------------------------------------
;淫乱
IF TALENT:ARG:淫乱
	TIMES CUP:ARG:快Ｃ , 1.20
	TIMES CUP:ARG:快Ｖ , 1.20
	TIMES CUP:ARG:快Ａ , 1.20
	TIMES CUP:ARG:快Ｂ , 1.20
ENDIF
;-------------------------------------------------
;素質
;-------------------------------------------------
;自制力
IF TALENT:ARG:自制力
	TIMES CUP:ARG:快Ｃ , 0.70
	TIMES CUP:ARG:快Ｖ , 0.90
	TIMES CUP:ARG:快Ａ , 1.00
	TIMES CUP:ARG:快Ｂ , 0.70
ENDIF
	;容易高潮
IF TALENT:ARG:容易高潮
	TIMES CUP:ARG:快Ｃ , 2.00
	TIMES CUP:ARG:快Ｖ , 2.00
	TIMES CUP:ARG:快Ａ , 2.00
	TIMES CUP:ARG:快Ｂ , 2.00
ENDIF
;自慰狂
SIF TALENT:ARG:自慰狂
	TIMES CUP:ARG:快Ｃ , 1.20
;淫壶
SIF TALENT:ARG:淫壶
	TIMES CUP:ARG:快Ｖ , 1.20
;尻穴狂
SIF TALENT:ARG:尻穴狂
	TIMES CUP:ARG:快Ａ , 1.20
;淫乳
SIF TALENT:ARG:淫乳
	TIMES CUP:ARG:快Ｂ , 1.20
	;男人
IF !(TALENT:ARG:2 & 1)
	TIMES CUP:ARG:快Ａ , 1.30
ENDIF
;-------------------------------------------------
;難易度による上下の処理（快楽系）
;-------------------------------------------------
;-------------------------------------------------
;愛液処理
;-------------------------------------------------
LOCAL:1 = CUP:ARG:快Ｃ + CUP:ARG:快Ｖ + CUP:ARG:快Ａ + CUP:ARG:快Ｂ
;快Ｃ＋快Ｖ＋快Ａ＋快Ｂが合わせて100以上上昇ならその20%の液体のソースが加わる
IF LOCAL:1 > 100
	;容易湿と不易湿はここで処理
	LOCAL:1 = LOCAL:1 * (10 + 5 * TALENT:ARG:濡れやすさ) / 10
	SOURCE:ARG:液体 += LOCAL:1 / 5
ENDIF

@SOURCE_情愛(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:情愛

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 0.10
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		TIMES LOCAL , 6.00
ENDSELECT
CUP:ARG:恭顺 += LOCAL

LOCAL = SOURCE:ARG:情愛
;欲望を見る
SELECTCASE ABL:ARG:欲望
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.40
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.60
	CASE 5
		TIMES LOCAL , 2.00
	CASE 6
		TIMES LOCAL , 2.40
	CASE 7
		TIMES LOCAL , 2.80
	CASE 8
		TIMES LOCAL , 3.20
	CASE 9
		TIMES LOCAL , 3.60
	CASEELSE
		TIMES LOCAL , 5.00
ENDSELECT
CUP:ARG:情欲 += LOCAL

@SOURCE_性行動(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:性行動

;ABL:技巧をみる
SELECTCASE ABL:ARG:技巧
	CASE 0
		TIMES LOCAL , 0.60
	CASE 1
		TIMES LOCAL , 1.20
	CASE 2
		TIMES LOCAL , 1.80
	CASE 3
		TIMES LOCAL , 2.40
	CASE 4
		TIMES LOCAL , 3.00
	CASE 5
		TIMES LOCAL , 3.60
	CASE 6
		TIMES LOCAL , 4.20
	CASE 7
		TIMES LOCAL , 4.80
	CASE 8
		TIMES LOCAL , 5.40
	CASE 9
		TIMES LOCAL , 6.00
	CASEELSE
		TIMES LOCAL , 7.00
ENDSELECT

;ABL:侍奉精神をみる
SELECTCASE ABL:ARG:侍奉精神
	CASE 0
		TIMES LOCAL , 0.60
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.40
	CASE 5
		TIMES LOCAL , 1.70
	CASE 6
		TIMES LOCAL , 2.00
	CASE 7
		TIMES LOCAL , 2.40
	CASE 8
		TIMES LOCAL , 2.80
	CASE 9
		TIMES LOCAL , 4.00
	CASEELSE
		TIMES LOCAL , 5.00
ENDSELECT
CUP:ARG:学习 += LOCAL


@SOURCE_達成(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:達成

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 1.00
	CASE 2
		TIMES LOCAL , 1.50
	CASE 3
		TIMES LOCAL , 2.00
	CASE 4
		TIMES LOCAL , 2.50
	CASE 5
		TIMES LOCAL , 3.00
	CASE 6
		TIMES LOCAL , 3.50
	CASE 7
		TIMES LOCAL , 4.00
	CASE 8
		TIMES LOCAL , 4.50
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		TIMES LOCAL , 6.00
ENDSELECT
;ABL:侍奉精神をみる
SELECTCASE ABL:ARG:侍奉精神
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.50
	CASE 2
		TIMES LOCAL , 1.00
	CASE 3
		TIMES LOCAL , 1.50
	CASE 4
		TIMES LOCAL , 2.00
	CASE 5
		TIMES LOCAL , 2.50
	CASE 6
		TIMES LOCAL , 3.00
	CASE 7
		TIMES LOCAL , 3.50
	CASE 8
		TIMES LOCAL , 4.00
	CASE 9
		TIMES LOCAL , 4.50
	CASEELSE
		TIMES LOCAL , 6.00
ENDSELECT

CUP:ARG:恭顺 += LOCAL

@SOURCE_痛苦(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:痛苦
LOCAL:1 = SOURCE:ARG:痛苦
LOCAL:2 = SOURCE:ARG:痛苦 / 20

;受虐属性
SELECTCASE ABL:ARG:受虐属性
	CASE 0
		TIMES LOCAL:1 , 0.00
	CASE 1
		TIMES LOCAL:1 , 0.10
	CASE 2
		TIMES LOCAL:1 , 0.20
	CASE 3
		TIMES LOCAL:1 , 0.30
	CASE 4
		TIMES LOCAL:1 , 0.45
	CASE 5
		TIMES LOCAL:1 , 0.60
	CASE 6
		TIMES LOCAL:1 , 0.75
	CASE 7
		TIMES LOCAL:1 , 0.90
	CASE 8
		TIMES LOCAL:1 , 1.20
	CASE 9
		TIMES LOCAL:1 , 1.50
	CASEELSE
		TIMES LOCAL:1 , 3.00
ENDSELECT

;小人体型
IF TALENT:ARG:体型 < -2
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.75
ENDIF
;調教者が【施虐狂】
SIF TCVAR:ARG:行為対象 && TALENT:(TCVAR:ARG:行為対象):施虐狂
	TIMES LOCAL:1 , 2.50
;胆怯
SIF TALENT:ARG:度胸 < 0
	TIMES LOCAL:2 , 2.00

;受虐属性があるとPALAM:情欲も上がる
;そのとき調教者が【施虐狂】だと効果的
;痛苦に応じて恐怖のソースが増加する
CUP:ARG:痛苦 += LOCAL
CUP:ARG:情欲 += LOCAL:1
CUP:ARG:恐怖 += LOCAL:2

@SOURCE_恐怖(ARG)
VARSET LOCAL

LOCAL= SOURCE:ARG:恐怖

;ABL:従順をみる（恐怖よりは畏怖に近いと解釈）
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL, 1.00
	CASE 1
		TIMES LOCAL, 1.50
	CASE 2
		TIMES LOCAL, 2.00
	CASE 3
		TIMES LOCAL, 2.50
	CASE 4
		TIMES LOCAL, 3.00
	CASE 5
		TIMES LOCAL, 3.50
	CASE 6
		TIMES LOCAL, 4.00
	CASE 7
		TIMES LOCAL, 4.50
	CASE 8
		TIMES LOCAL, 5.00
	CASE 9
		TIMES LOCAL, 5.50
	CASEELSE
		TIMES LOCAL, 7.00
ENDSELECT

CUP:ARG:恐怖 += LOCAL

@SOURCE_液体(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:液体
;小人体型
IF TALENT:ARG:体型 < -2
	SIF SELECTCOM != 50 && SELECTCOM != 180
		TIMES LOCAL , 0.40
ENDIF

CUP:ARG:润滑 += LOCAL


@SOURCE_情欲(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:情欲

;欲望を見る
SELECTCASE ABL:ARG:欲望
	CASE 0
		TIMES LOCAL , 0.20
	CASE 1
		TIMES LOCAL , 0.40
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 1.20
	CASE 4
		TIMES LOCAL , 1.60
	CASE 5
		TIMES LOCAL , 2.00
	CASE 6
		TIMES LOCAL , 2.40
	CASE 7
		TIMES LOCAL , 2.80
	CASE 8
		TIMES LOCAL , 3.20
	CASE 9
		TIMES LOCAL , 3.60
	CASEELSE
		TIMES LOCAL , 5.00
ENDSELECT

CUP:ARG:情欲 += LOCAL

@SOURCE_恭顺(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:恭顺

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 0.50
	CASE 0
		TIMES LOCAL , 0.80
	CASE 0
		TIMES LOCAL , 1.00
	CASE 0
		TIMES LOCAL , 1.20
	CASE 0
		TIMES LOCAL , 1.40
	CASE 0
		TIMES LOCAL , 1.60
	CASE 0
		TIMES LOCAL , 1.80
	CASE 0
		TIMES LOCAL , 2.00
	CASE 0
		TIMES LOCAL , 2.40
	CASE 0
		TIMES LOCAL , 3.00
	CASE 0
		TIMES LOCAL , 5.00
ENDSELECT
CUP:ARG:恭顺 += LOCAL

@SOURCE_露出(ARG)
VARSET LOCAL
;害羞と不知羞耻はここで処理
SIF TALENT:ARG:羞恥心 > 0
	TIMES SOURCE:ARG:露出 , 2.00
SIF TALENT:ARG:羞恥心 < 0
	TIMES SOURCE:ARG:露出 , 0.50

;润滑アップの50％を露出のソースに加える
;ただし液体追加のソースのぶんは引く
SOURCE:ARG:露出 += (CUP:ARG:润滑 - SOURCE:ARG:液体) / 2

LOCAL = SOURCE:ARG:露出

;ABL:露出癖をみる
SELECTCASE ABL:ARG:露出癖
	CASE 0
		TIMES LOCAL , 0.00
	CASE 1
		TIMES LOCAL , 0.10
	CASE 2
		TIMES LOCAL , 0.20
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.80
	CASE 6
		TIMES LOCAL , 1.00
	CASE 7
		TIMES LOCAL , 1.20
	CASE 8
		TIMES LOCAL , 1.40
	CASE 9
		TIMES LOCAL , 1.60
	CASEELSE
		TIMES LOCAL , 2.00
ENDSELECT
CUP:ARG:情欲 += LOCAL

LOCAL = SOURCE:ARG:露出

;PALAM:耻情をみる
;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
IF PALAM:ARG:耻情 < PALAMLV:1
	TIMES LOCAL , 1.00
ELSEIF PALAM:ARG:耻情 < PALAMLV:2
	TIMES LOCAL , 0.90
ELSEIF PALAM:ARG:耻情 < PALAMLV:3
	TIMES LOCAL , 0.80
ELSEIF PALAM:ARG:耻情 < PALAMLV:4
	TIMES LOCAL , 0.70
ELSEIF PALAM:ARG:耻情 >= PALAMLV:4
	TIMES LOCAL , 0.60
ENDIF

CUP:ARG:耻情 += LOCAL

@SOURCE_屈従(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:屈従

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 0.50
	CASE 1
		TIMES LOCAL , 1.00
	CASE 2
		TIMES LOCAL , 1.50
	CASE 3
		TIMES LOCAL , 2.00
	CASE 4
		TIMES LOCAL , 2.50
	CASE 5
		TIMES LOCAL , 3.00
	CASE 6
		TIMES LOCAL , 3.50
	CASE 7
		TIMES LOCAL , 4.00
	CASE 8
		TIMES LOCAL , 4.50
	CASE 9
		TIMES LOCAL , 5.00
	CASEELSE
		TIMES LOCAL , 6.00
ENDSELECT
;ABL:侍奉精神をみる
SELECTCASE ABL:ARG:侍奉精神
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 1.50
	CASE 2
		TIMES LOCAL , 2.00
	CASE 3
		TIMES LOCAL , 2.50
	CASE 4
		TIMES LOCAL , 3.00
	CASE 5
		TIMES LOCAL , 3.50
	CASE 6
		TIMES LOCAL , 4.00
	CASE 7
		TIMES LOCAL , 4.50
	CASE 8
		TIMES LOCAL , 5.00
	CASE 9
		TIMES LOCAL , 5.50
	CASEELSE
		TIMES LOCAL , 7.00
ENDSELECT
CUP:ARG:屈服 += LOCAL

@SOURCE_奉仕(ARG)
SOURCE:ARG:奉仕 = SOURCE:ARG:奉仕 * GET_REVISION(ABL:ARG:技巧 + ABL:ARG:侍奉精神 + 2, 500, 10) / 100
LOCAL = SOURCE:ARG:奉仕
LOCAL:1 = SOURCE:ARG:奉仕

LOCAL = LOCAL * (100 + GET_REVISION(ABL:ARG:欲望, 500, 10)) / 100
CUP:ARG:情欲 += LOCAL
LOCAL:1 = LOCAL:1 * (100 + GET_REVISION(ABL:ARG:受虐属性, 500, 5)) / 100
CUP:ARG:屈服 += LOCAL:1


@SOURCE_歓楽(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:歓楽

IF TCVAR:ARG:行為対象
	LOCAL = LOCAL * (10 + 5 * LOVE_CHECK(ARG,TCVAR:ARG:行為対象)) / 10

	;好感度を見る
	IF TA:ARG:(TCVAR:ARG:行為対象):3 <= 10
		TIMES LOCAL , 0.50
	ELSEIF TA:ARG:(TCVAR:ARG:行為対象):3 <= 50
		TIMES LOCAL , 0.80
	ELSEIF TA:ARG:(TCVAR:ARG:行為対象):3 <= 100
		TIMES LOCAL , 1.00
	ELSEIF TA:ARG:(TCVAR:ARG:行為対象):3 <= 300
		TIMES LOCAL , 1.10
	ELSEIF TA:ARG:(TCVAR:ARG:行為対象):3 <= 500
		TIMES LOCAL , 1.20
	ELSEIF TA:ARG:(TCVAR:ARG:行為対象):3 <= 700
		TIMES LOCAL , 1.30
	ELSEIF TA:ARG:(TCVAR:ARG:行為対象):3 <= 1000
		TIMES LOCAL , 1.40
	ELSEIF TA:ARG:(TCVAR:ARG:行為対象):3 <= 3000
		TIMES LOCAL , 1.50
	ELSEIF TA:ARG:(TCVAR:ARG:行為対象):3 <= 5000
		TIMES LOCAL , 1.70
	ELSEIF TA:ARG:(TCVAR:ARG:行為対象):3 <= 500000
		IF LOCAL < 100000
			LOCAL = LOCAL * (TA:ARG:(TCVAR:ARG:行為対象):3 / 50 + 100) / 100
		ELSEIF LOCAL < 10000000
			LOCAL = LOCAL / 100 * (TA:ARG:(TCVAR:ARG:行為対象):3 / 50 + 100)
		ELSEIF LOCAL < 100000000
			IF TA:ARG:(TCVAR:ARG:行為対象):3 <= 50000
				LOCAL = LOCAL / 100 * (TA:ARG:(TCVAR:ARG:行為対象):3 / 50 + 100)
			ELSE
				LOCAL = 1000000000
			ENDIF
		ENDIF
	ENDIF
ENDIF
;ABL:欲望をみる
IF LOCAL < 100000
	LOCAL:1 = LOCAL * (ABL:ARG:欲望 * 5) / 10
ELSEIF LOCAL < 100000000
	LOCAL:1 = LOCAL / 100 * (ABL:ARG:欲望 * 5 + 100)
ENDIF
LOCAL:3 = LOCAL * (ABL:ARG:施虐属性 + ABL:(TCVAR:ARG:行為対象):受虐属性 + ABL:(TCVAR:ARG:行為対象):従順)
LOCAL:4 = LOCAL * (ABL:ARG:受虐属性 + ABL:ARG:従順 + ABL:(TCVAR:ARG:行為対象):施虐属性)

CUP:ARG:情欲 += LOCAL:1
CUP:ARG:優越 += LOCAL:3
CUP:ARG:恭顺 += LOCAL:4
;好意度、情欲度に+1	SOURCS.ERBの397でやってるっぽい
;;;SIF (LOCAL:1 > 1000) | (LOCAL:3 > 1000) | (LOCAL:4 > 500)
;;;	TA:ARG:(TCVAR:ARG:行為対象):3 += 1
;;;SIF LOCAL:3 > 1000
;;;	TA:(TCVAR:ARG:行為対象):ARG:4 += 1
;---------------------------------------------------
;マイナスSOURCE
;---------------------------------------------------
@SOURCE_不潔(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:不潔

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

CUP:ARG:不快 += LOCAL

@SOURCE_鬱屈(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:鬱屈

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
;ABL:欲望をみる
SELECTCASE ABL:ARG:欲望
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
CUP:ARG:抑郁 += LOCAL


@SOURCE_逸脱(ARG)
VARSET LOCAL
;好奇心と保守はここで処理
SIF TALENT:ARG:性的興味 > 0
	TIMES SOURCE:ARG:逸脱 , 0.80
SIF TALENT:ARG:性的興味 < 0
	TIMES SOURCE:ARG:逸脱 , 2.00

LOCAL = SOURCE:ARG:逸脱

;ABL:従順をみる
SELECTCASE ABL:ARG:従順
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

;ABL:受虐属性をみる
SELECTCASE ABL:ARG:受虐属性
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

CUP:ARG:反感 += LOCAL

@SOURCE_反感(ARG)
VARSET LOCAL
LOCAL = SOURCE:ARG:反感

;ABL:従順をみる
LOCAL:1 = ABL:ARG:従順 + ABL:ARG:親密
SELECTCASE LOCAL:1
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.80
	CASE 2
		TIMES LOCAL , 0.60
	CASE 3
		TIMES LOCAL , 0.40
	CASE 4
		TIMES LOCAL , 0.30
	CASE 5
		TIMES LOCAL , 0.20
	CASE 6
		TIMES LOCAL , 0.10
	CASE 7
		TIMES LOCAL , 0.08
	CASE 8
		TIMES LOCAL , 0.06
	CASE 9
		TIMES LOCAL , 0.04
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

;ABL:侍奉精神をみる
SELECTCASE ABL:ARG:侍奉精神
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT

;ABL:受虐属性をみる
SELECTCASE ABL:ARG:受虐属性
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.90
	CASE 2
		TIMES LOCAL , 0.80
	CASE 3
		TIMES LOCAL , 0.70
	CASE 4
		TIMES LOCAL , 0.60
	CASE 5
		TIMES LOCAL , 0.50
	CASE 6
		TIMES LOCAL , 0.40
	CASE 7
		TIMES LOCAL , 0.30
	CASE 8
		TIMES LOCAL , 0.20
	CASE 9
		TIMES LOCAL , 0.10
	CASEELSE
		TIMES LOCAL , 0.00
ENDSELECT
CUP:ARG:反感 += LOCAL


@SOURCE_EXTRA(ARG)
VARSET LOCAL
;-------------------------------------------------
;装備系（薬等）
;-------------------------------------------------
;春药
IF TEQUIP:ARG:春药
	TIMES CUP:ARG:恭顺 , 1.20
	TIMES CUP:ARG:情欲 , 2.00
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:不快 , 0.75
ENDIF

;利尿剂
IF TEQUIP:ARG:利尿剂
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:情欲 , 0.80
	TIMES CUP:ARG:耻情 , 1.20
	TIMES CUP:ARG:反感 , 1.50
	TIMES CUP:ARG:不快 , 1.20
ENDIF
;-------------------------------------------------
;陥落素質
;-------------------------------------------------
IF TCVAR:ARG:行為対象 && CFLAG:ARG:最愛
	IF TCVAR:ARG:行為対象 == CFLAG:ARG:最愛
		;最愛の人
		TIMES CUP:ARG:恭顺 , 2.00
		TIMES CUP:ARG:屈服 , 2.00
		SIF CUP:ARG:好意 < 999999999
			TIMES CUP:ARG:好意 , 2.00
		TIMES CUP:ARG:反感 , 0.10
		TIMES CUP:ARG:不快 , 0.10
		TIMES CUP:ARG:抑郁 , 0.10
		
	ELSEIF !LOVE_CHECK(ARG,TCVAR:ARG:行為対象)
		;最愛の人でなく恋慕対象でもない(恋慕対象の場合はペナを受けない)
		TIMES CUP:ARG:恭顺 , 0.80
		TIMES CUP:ARG:反感 , 1.20
		TIMES CUP:ARG:不快 , 1.20
		TIMES CUP:ARG:抑郁 , 1.50
	ENDIF
ELSEIF TCVAR:ARG:行為対象 && LOVE_CHECK(ARG,TCVAR:ARG:行為対象)
	;最愛の人がいなく恋慕対象
	TIMES CUP:ARG:恭顺 , 1.50
	TIMES CUP:ARG:屈服 , 1.50
	SIF CUP:ARG:好意 < 999999999
		TIMES CUP:ARG:好意 , 1.50
	TIMES CUP:ARG:反感 , 0.50
	TIMES CUP:ARG:不快 , 0.50
	TIMES CUP:ARG:抑郁 , 0.50
ENDIF

;淫乱
IF TALENT:ARG:淫乱
	CUP:ARG:恭顺 = CUP:ARG:恭顺 * (10 + 2 * TALENT:ARG:淫乱) / 10
	CUP:ARG:屈服 = CUP:ARG:屈服 * (10 + 2 * TALENT:ARG:淫乱) / 10
	CUP:ARG:反感 = CUP:ARG:反感 * (10 - 2 * TALENT:ARG:淫乱) / 10
	CUP:ARG:不快 = CUP:ARG:不快 * (10 - 2 * TALENT:ARG:淫乱) / 10
	TIMES CUP:ARG:抑郁 , 0.40
ENDIF
;-------------------------------------------------
;素質
;-------------------------------------------------
;刚强
IF TALENT:ARG:度胸 > 0
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:情欲 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:好意 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:抑郁 , 1.20
ENDIF
;胆怯
IF TALENT:ARG:度胸 < 0
	TIMES CUP:ARG:恐怖 , 1.20
	TIMES CUP:ARG:反感 , 1.20
ENDIF
;反抗（服从、隶属、最愛で無効）
IF TALENT:ARG:態度 > 0 && !TALENT:ARG:服从 && (TCVAR:ARG:行為対象 && TCVAR:ARG:行為対象 != CFLAG:ARG:最愛)
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	;TIMES CUP:ARG:好意 , 0.80
	TIMES CUP:ARG:反感 , 1.20
ENDIF
;直率
IF TALENT:ARG:態度 < 0
	TIMES CUP:ARG:恭顺 , 1.20
	TIMES CUP:ARG:反感 , 0.80
	;SIF CUP:ARG:好意 < 999999999
		;TIMES CUP:ARG:好意 , 1.50
ENDIF
;自大
IF TALENT:ARG:応答 > 0 && (TCVAR:ARG:行為対象 && TCVAR:ARG:行為対象 != CFLAG:ARG:最愛)
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:反感 , 1.20
ENDIF
;老实
IF TALENT:ARG:応答 < 0
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:反感 , 0.80
ENDIF
;高傲
IF TALENT:ARG:プライド > 0
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:反感 , 1.20
ENDIF
;自卑
IF TALENT:ARG:プライド < 0
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:恐怖 , 1.20
	TIMES CUP:ARG:反感 , 0.80
ENDIF
;傲娇
IF TALENT:ARG:傲娇
	;陥落素質がある場合と無い場合で変化する
	IF (TCVAR:ARG:行為対象 && LOVE_CHECK(ARG,TCVAR:ARG:行為対象)) || TALENT:ARG:淫乱 || TALENT:ARG:服从
		TIMES CUP:ARG:恭顺 , 1.20
		TIMES CUP:ARG:屈服 , 1.20
		TIMES CUP:ARG:反感 , 0.80
	ELSE
		TIMES CUP:ARG:恭顺 , 0.80
		TIMES CUP:ARG:屈服 , 0.80
		TIMES CUP:ARG:反感 , 1.20
	ENDIF
ENDIF
;自制力
IF TALENT:ARG:自制力 && !TALENT:ARG:淫乱
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:反感 , 1.20
ENDIF
;无动于衷
IF TALENT:ARG:无动于衷 && (TCVAR:ARG:行為対象 && TCVAR:ARG:行為対象 != CFLAG:ARG:最愛)
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:情欲 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	;TIMES CUP:ARG:好意 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	TIMES CUP:ARG:反感 , 0.80
ENDIF
;缺乏感情
IF TALENT:ARG:缺乏感情 && (TCVAR:ARG:行為対象 && TCVAR:ARG:行為対象 != CFLAG:ARG:最愛)
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:情欲 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:耻情 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
	;TIMES CUP:ARG:好意 , 0.80
	TIMES CUP:ARG:反感 , 0.80
	TIMES CUP:ARG:不快 , 0.80
	TIMES CUP:ARG:抑郁 , 0.80
ENDIF
;好奇心
SIF TALENT:ARG:性的興味 > 0
	TIMES CUP:ARG:学习 , 1.20
;保守
SIF TALENT:ARG:性的興味 < 0
	TIMES CUP:ARG:学习 , 0.80
;乐观
SIF TALENT:ARG:陽気／陰気 > 0
	TIMES CUP:ARG:抑郁 , 0.80
;悲观
SIF TALENT:ARG:陽気／陰気 < 0
	TIMES CUP:ARG:抑郁 , 1.20
;喜欢引人注目
SIF TALENT:ARG:喜欢引人注目
	TIMES CUP:ARG:恭顺 , 1.20

;压抑
IF TALENT:ARG:自己愛 < 0  && !TALENT:ARG:淫乱 && (TCVAR:ARG:行為対象 && TCVAR:ARG:行為対象 != CFLAG:ARG:最愛)
	TIMES CUP:ARG:情欲 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:抑郁 , 1.20
ENDIF
;解放
IF TALENT:ARG:自己愛 > 0
	TIMES CUP:ARG:情欲 , 1.20
	TIMES CUP:ARG:屈服 , 1.20
ENDIF
;反抗
IF TALENT:ARG:反抗  && !TALENT:ARG:淫乱 && (TCVAR:ARG:行為対象 && TCVAR:ARG:行為対象 != CFLAG:ARG:最愛)
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:抑郁 , 1.20
ENDIF

;痛心灵感知
CUP:ARG:痛苦 = CUP:ARG:痛苦 * (10 + 2 * TALENT:ARG:痛心灵感知) / 10

;学习速度
CUP:ARG:学习 = CUP:ARG:学习 * (10 + 2 * TALENT:ARG:学习速度) / 10


;献身
SIF TALENT:ARG:献身
	TIMES CUP:ARG:屈服 , 1.20

;接受快感
SIF TALENT:ARG:快感応答 > 0
	TIMES CUP:ARG:情欲 , 1.20
;否定快感（淫乱、娼妇で無効）
SIF TALENT:ARG:快感応答 < 0 && !TALENT:ARG:淫乱
	TIMES CUP:ARG:情欲 , 0.80
;容易高潮
IF TALENT:ARG:容易高潮
	TIMES CUP:ARG:恭顺 , 2.00
	TIMES CUP:ARG:情欲 , 2.00
	TIMES CUP:ARG:屈服 , 2.00
	TIMES CUP:ARG:学习 , 2.00
	TIMES CUP:ARG:耻情 , 2.00
	TIMES CUP:ARG:恐怖 , 2.00
	TIMES CUP:ARG:反感 , 0.50
	TIMES CUP:ARG:不快 , 0.50
	TIMES CUP:ARG:抑郁 , 0.50
ENDIF
;自慰狂
SIF TALENT:ARG:自慰狂
	TIMES CUP:ARG:情欲 , 1.20
;淫壶
SIF TALENT:ARG:淫壶
	TIMES CUP:ARG:恭顺 , 1.20
;尻穴狂
SIF TALENT:ARG:尻穴狂
	TIMES CUP:ARG:屈服 , 1.20
;淫乳
SIF TALENT:ARG:淫乳
	TIMES CUP:ARG:耻情 , 1.20

;性变态
IF TALENT:ARG:性变态
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:耻情 , 1.20
ENDIF
;讨厌男人（恋慕、最愛で無効）
IF TALENT:ARG:性別嗜好 & 1 && TCVAR:ARG:行為対象 && GETBIT(TALENT:(TCVAR:ARG:行為対象):2,1) && TCVAR:ARG:行為対象 != CFLAG:ARG:最愛 && !LOVE_CHECK(ARG,TCVAR:ARG:行為対象)
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:情欲 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:学习 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:不快 , 1.20
ENDIF
;施虐狂
IF TALENT:ARG:施虐狂
	TIMES CUP:ARG:優越 , 2.00
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:恐怖 , 0.80
ENDIF
;受虐狂
IF TALENT:ARG:受虐狂
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:恐怖 , 1.20
	TIMES CUP:ARG:抑郁 , 0.80
ENDIF
IF TALENT:ARG:小恶魔
	TIMES CUP:ARG:優越 , 1.50
ENDIF
;迷信
IF TALENT:ARG:迷信
	TIMES CUP:ARG:屈服 , 1.20
	TIMES CUP:ARG:反感 , 0.80
ENDIF
;讨厌女人（恋慕、最愛で無効）
IF TALENT:ARG:性別嗜好 & 2 && TCVAR:ARG:行為対象 && GETBIT(TALENT:(TCVAR:ARG:行為対象):2,0) && TCVAR:ARG:行為対象 != CFLAG:ARG:最愛 && !LOVE_CHECK(ARG,TCVAR:ARG:行為対象)
	TIMES CUP:ARG:恭顺 , 0.80
	TIMES CUP:ARG:情欲 , 0.80
	TIMES CUP:ARG:屈服 , 0.80
	TIMES CUP:ARG:学习 , 0.80
	TIMES CUP:ARG:反感 , 1.20
	TIMES CUP:ARG:不快 , 1.20
ENDIF

;-------------------------------------------------
;その他
;-------------------------------------------------
;痛苦刻印
IF MARK:ARG:痛苦刻印 == 3
	TIMES CUP:ARG:痛苦 , 1.30
	TIMES CUP:ARG:恐怖 , 1.30
ELSEIF MARK:ARG:痛苦刻印 == 2
	TIMES CUP:ARG:痛苦 , 1.20
	TIMES CUP:ARG:恐怖 , 1.20
ELSEIF MARK:ARG:痛苦刻印 == 1
	TIMES CUP:ARG:痛苦 , 1.10
	TIMES CUP:ARG:恐怖 , 1.10
ENDIF

;快乐刻印
IF MARK:ARG:快乐刻印 == 3
	TIMES CUP:ARG:情欲 , 1.30
	TIMES CUP:ARG:学习 , 1.30
ELSEIF MARK:ARG:快乐刻印 == 2
	TIMES CUP:ARG:情欲 , 1.20
	TIMES CUP:ARG:学习 , 1.20
ELSEIF MARK:ARG:快乐刻印 == 1
	TIMES CUP:ARG:情欲 , 1.10
	TIMES CUP:ARG:学习 , 1.10
ENDIF

;屈服刻印
IF MARK:ARG:屈服刻印 == 3
	TIMES CUP:ARG:恭顺 , 1.30
	TIMES CUP:ARG:屈服 , 1.30
ELSEIF MARK:ARG:屈服刻印 == 2
	TIMES CUP:ARG:恭顺 , 1.20
	TIMES CUP:ARG:屈服 , 1.20
ELSEIF MARK:ARG:屈服刻印 == 1
	TIMES CUP:ARG:恭顺 , 1.10
	TIMES CUP:ARG:屈服 , 1.10
ENDIF

;反抗刻印
IF MARK:ARG:反抗刻印 == 3
	TIMES CUP:ARG:恭顺 , 0.10
	TIMES CUP:ARG:反感 , 1.30
ELSEIF MARK:ARG:反抗刻印 == 2
	TIMES CUP:ARG:恭顺 , 0.40
	TIMES CUP:ARG:反感 , 1.20
ELSEIF MARK:ARG:反抗刻印 == 1
	TIMES CUP:ARG:恭顺 , 0.60
	TIMES CUP:ARG:反感 , 1.10
ENDIF
;-------------------------------------------------
;難易度などによる上下の処理
;-------------------------------------------------
;-------------------------------------------------
;相性による上下の処理
;-------------------------------------------------
IF TCVAR:ARG:行為対象 && RELATION:ARG:(TCVAR:ARG:行為対象) != 0
	CUP:ARG:情欲 *= RELATION:ARG:(TCVAR:ARG:行為対象)
	CUP:ARG:情欲 /= 100
	CUP:ARG:屈服 *= RELATION:ARG:(TCVAR:ARG:行為対象)
	CUP:ARG:屈服 /= 100
	CUP:ARG:耻情 *= RELATION:ARG:(TCVAR:ARG:行為対象)
	CUP:ARG:耻情 /= 100
	CUP:ARG:反感 *= 100
	CUP:ARG:反感 /= RELATION:ARG:(TCVAR:ARG:行為対象)
	CUP:ARG:不快 *= 100
	CUP:ARG:不快 /= RELATION:ARG:(TCVAR:ARG:行為対象)
	CUP:ARG:抑郁 *= 100
	CUP:ARG:抑郁 /= RELATION:ARG:(TCVAR:ARG:行為対象)
ENDIF
;-------------------------------------------------
;气力０による上下の処理
;-------------------------------------------------
IF BASE:ARG:1 <= 0
	;UP:0,1,2は絶頂に絡むので先に処理してある
	CUP:ARG:情欲 /= 2
	CUP:ARG:恭顺 /= 2
	CUP:ARG:屈服 /= 2
	CUP:ARG:学习 /= 2
	CUP:ARG:耻情 /= 2
	CUP:ARG:恐怖 /= 2
	CUP:ARG:痛苦 /= 2

	DOWNBASE:ARG:体力 *= 2
	DOWNBASE:ARG:体力 += 80
ENDIF

;-------------------------------------------------
;痛苦からくる体力・气力の減少
;-------------------------------------------------
LOCAL = CUP:ARG:痛苦 / 20
;ABL:受虐属性をみる
SELECTCASE ABL:ARG:受虐属性
	CASE 0
		TIMES LOCAL , 1.00
	CASE 1
		TIMES LOCAL , 0.95
	CASE 2
		TIMES LOCAL , 0.90
	CASE 3
		TIMES LOCAL , 0.80
	CASE 4
		TIMES LOCAL , 0.65
	CASEELSE
		TIMES LOCAL , 0.50
ENDSELECT
;痛心灵感知
LOCAL = LOCAL * (10 + TALENT:ARG:痛心灵感知 * 2) / 10

DOWNBASE:ARG:体力 += LOCAL
DOWNBASE:ARG:气力 += LOCAL

@SOURCE_DOWNBASE(ARG)
IF DOWNBASE:ARG:体力 > 0
	DOWNBASE:ARG:体力 = DOWNBASE:ARG:体力 + 2 * DOWNBASE:ARG:体力 * BASE:ARG:疲労 / MAXBASE:ARG:疲労
ELSE
	DOWNBASE:ARG:体力 = DOWNBASE:ARG:体力 / 4 + 3 * DOWNBASE:ARG:体力 * (MAXBASE:ARG:疲労 - BASE:ARG:疲労) / (MAXBASE:ARG:疲労 * 4)
ENDIF
BASE:ARG:体力 = LIMIT(BASE:ARG:体力 - DOWNBASE:ARG:体力,0,MAXBASE:ARG:体力)

IF DOWNBASE:ARG:气力 > 0
	DOWNBASE:ARG:气力 = DOWNBASE:ARG:气力 + 2 * DOWNBASE:ARG:气力 * BASE:ARG:ストレス / MAXBASE:ARG:ストレス
ELSE
	DOWNBASE:ARG:气力 = DOWNBASE:ARG:气力 / 4 + 3 * DOWNBASE:ARG:气力 * (MAXBASE:ARG:ストレス - BASE:ARG:ストレス) / (MAXBASE:ARG:ストレス * 4)
ENDIF
BASE:ARG:气力 = LIMIT(BASE:ARG:气力 - DOWNBASE:ARG:气力,0,MAXBASE:ARG:气力)
BASE:ARG:疲労 = LIMIT(BASE:ARG:疲労 - DOWNBASE:ARG:疲労,0,MAXBASE:ARG:疲労)
BASE:ARG:ストレス = LIMIT(BASE:ARG:ストレス - DOWNBASE:ARG:ストレス,0,MAXBASE:ARG:ストレス)
