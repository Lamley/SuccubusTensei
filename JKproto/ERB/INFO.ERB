@SHOW_STATUS
VARSET LOCAL
DRAWLINE
FOR LOCAL,1,CHARANUM
	SIF LOCAL == MASTER
		CONTINUE
	SIF !CFLAG:LOCAL:会话 && CFLAG:LOCAL:現在地区 == CFLAG:MASTER:現在地区 && CFLAG:LOCAL:現在位置 == CFLAG:MASTER:現在位置 && !CFLAG:LOCAL:衰弱 && !CFLAG:LOCAL:睡眠
		PRINTFORM (%CALLNAME:LOCAL%)
NEXT
PRINTL 
IF TCVAR:MASTER:イベント == 1 || TCVAR:MASTER:イベント == 2
	IF TFLAG:騒ぎ
		PRINTFORML 　　　　骚动：{TFLAG:騒ぎ}
	ELSE
		PRINTL
	ENDIF
	IF CFLAG:MASTER:乗車 == 1
		PRINT 電車到着地:
		PRINTFORM %PLACE_NAME(CFLAG:MASTER:到着地区,CFLAG:MASTER:到着位置)%
		PRINTFORML （到着時間:{CFLAG:MASTER:到着時間 / 60}時{CFLAG:MASTER:到着時間 % 60}分）
	ENDIF
ENDIF
;显示目前场景的npc

PRINTFORM {DAY:1}年目{DAY:2}月{DAY:3}日% WEEK(DAY)%曜日
SETCOLOR 0xFFD700
PRINTFORM  %TSTR:11%
RESETCOLOR
PRINTFORM  {TIME / 60}時{TIME % 60}分
IF !HOLIDAY()
	SELECTCASE TIME
		CASE 390 TO 510
			PRINTFORM (授業開始{510 - TIME}分前)
		CASE 510 TO 749
			PRINT (授業中)
		CASE 750 TO 810
			PRINTFORM (授業開始{810 - TIME}分前)
		CASE 810 TO 959
			PRINT (授業中)
	ENDSELECT
ENDIF
PRINTFORM   所持金:{MONEY:MASTER}円 

PRINTL 

PRINTFORM NPCの人数 = {N:101}

J:102 = 1
FOR J:101,1,CHARANUM
	SIF TB:(CFLAG:1:現在地区):(CFLAG:1:現在位置):(J:101) > TB:(CFLAG:1:現在地区):(CFLAG:1:現在位置):(J:102)
		J:102 = J:101
;		PRINTFORM    %NAME:(J:101)%の
;        PRINTFORM   支配度 = {TB:(CFLAG:1:現在地区):(CFLAG:1:現在位置):(J:101)}，
NEXT

PRINTFORM   『支配者 = %NAME:(J:102)%
PRINTFORM   支配度 = {TB:(CFLAG:1:現在地区):(CFLAG:1:現在位置):(J:102)}）』

PRINTL 

PRINTFORM 現在位置:
SETCOLOR 0xFFAA00
IF CFLAG:MASTER:乗車 == 1
	PRINT 電車内(乗車中)
ELSE
	PRINTFORM %PLACE_NAME(CFLAG:MASTER:現在地区,CFLAG:MASTER:現在位置)%
ENDIF
RESETCOLOR
SIF GETBIT(DA:(CFLAG:MASTER:現在地区):(CFLAG:MASTER:現在位置),3)
	PRINT (室内)
SIF CFLAG:MASTER:部活
	PRINTFORM   部活:%CLUB_NAME(CFLAG:MASTER:部活)%
SIF CFLAG:MASTER:職業
	PRINTFORM   バイト先:%JOB_NAME(CFLAG:MASTER:職業)%
SIF CFLAG:MASTER:所属
	PRINTFORM   所属:%DANTAI_NAME(CFLAG:MASTER:所属)%
PRINTL 

IF CFLAG:1:現在地区 == 2 && CFLAG:1:現在位置 == 22
	SETCOLOR 0xFFAA00
	PRINTL 宿泊費：３０００円
	RESETCOLOR
ENDIF

PRINTFORML 名前:%CALLNAME:MASTER%     

LOCAL:1 = STRLENS(CALLNAME:MASTER)

LOCAL = MAX(BASE:MASTER:評判 / 100,1)
PRINTFORM     評判:
SIF BASE:MASTER:評判 < 100
	SETCOLOR 0,0,255
IF LOCAL < 13
	PRINTFORM %"♪" * LOCAL%
	PRINTFORM %" " * (24 - LOCAL * 2)% {BASE:1:評判}
ELSE
	PRINTFORM {BASE:1:評判}
ENDIF
RESETCOLOR

LOCAL = MAX(BASE:MASTER:容姿 / 100,1)
PRINTFORM     容姿:
SIF BASE:MASTER:容姿 > 800
	SETCOLOR 255,255,0
PRINTFORM %"◆" * LOCAL%
PRINTFORM %" " * (24 - LOCAL * 2)% {BASE:1:容姿}
RESETCOLOR
;PRINTL 

LOCAL = MAX(BASE:MASTER:学习成绩 / 100,1)
PRINTFORM     学习成绩:
SIF BASE:MASTER:学习成绩 < 100
	SETCOLOR 0,0,255
;PRINTFORM %"☆" * LOCAL%
IF LOCAL < 13
	PRINTFORM %UNICODE(0x2710) * LOCAL%
	PRINTFORM %" " * (24 - LOCAL * 2)% {BASE:1:学习成绩}
ELSE
	PRINTFORM {BASE:1:学习成绩}
ENDIF
RESETCOLOR
PRINTL 

LOCAL = LIMIT(BASE:MASTER:刺激度 / 100,0,10)
PRINTFORM   刺激度:
SIF BASE:MASTER:刺激度 >= 600
	SETCOLOR 255,51,153
SIF BASE:MASTER:刺激度 >= 900
	SETCOLOR 255,0,0
IF LOCAL < 13
	PRINTFORM %UNICODE(0x2665) * LOCAL%
	PRINTFORM %" " * (24 - LOCAL)% {BASE:1:刺激度}
ELSE
	PRINTFORM {BASE:1:刺激度}
ENDIF
RESETCOLOR
;PRINTL 

LOCAL = LIMIT(BASE:MASTER:疲労 / 1000,0,10)
PRINTFORM     疲労:
SIF BASE:MASTER:疲労 >= 5000
	SETCOLOR 255,255,0
SIF BASE:MASTER:疲労 >= 7500
	SETCOLOR 255,0,0
PRINTFORM %UNICODE(0x2666) * LOCAL%
PRINTFORM %" " * (24 - LOCAL)% {BASE:1:疲労}
RESETCOLOR

LOCAL = LIMIT(BASE:MASTER:ストレス / 1000,0,10)
PRINTFORM ストレス:
SIF BASE:MASTER:ストレス >= 5000
	SETCOLOR 255,255,0
SIF BASE:MASTER:ストレス >= 7500
	SETCOLOR 255,0,0
PRINTFORM %UNICODE(0x2666) * LOCAL%
PRINTFORM %" " * (24 - LOCAL)% {BASE:1:ストレス}
RESETCOLOR
PRINTL 

LOCAL = LIMIT(BASE:MASTER:眠気 / 200,0,10)
PRINTFORM     眠気:
SIF BASE:MASTER:眠気 >= 1000
	SETCOLOR 255,255,0
SIF BASE:MASTER:眠気 >= 1600
	SETCOLOR 255,0,0
PRINTFORM %UNICODE(0x2666) * LOCAL%
PRINTFORM %" " * (24 - LOCAL)% {BASE:1:眠気}
RESETCOLOR
PRINTL 


DRAWLINE

LOCAL = LIMIT(BASE:MASTER:性欲 / 1000,0,10)
PRINTFORM   性欲(%CALLNAME:MASTER%):
SIF BASE:MASTER:性欲 == MAXBASE:MASTER:性欲
	SETCOLOR 255,51,153
PRINTFORM %UNICODE(0x2665) * LOCAL%
PRINTFORM %" " * (30 - LOCAL)% 
RESETCOLOR

IF TARGET
	LOCAL = LIMIT(BASE:TARGET:性欲 / 1000,0,10)
	PRINTFORM   性欲(%CALLNAME:TARGET%):
	SIF BASE:TARGET:性欲 == MAXBASE:TARGET:性欲
		SETCOLOR 255,51,153
	PRINTFORM %UNICODE(0x2665) * LOCAL% 
	RESETCOLOR

ENDIF
PRINTL 


LOCAL = LIMIT(BASE:MASTER:興奮度 / 100,0,10)
PRINTFORM 興奮度(%CALLNAME:MASTER%):
SIF BASE:MASTER:興奮度 == MAXBASE:MASTER:興奮度
	SETCOLOR 255,51,153
PRINTFORM %UNICODE(0x2665) * LOCAL%
PRINTFORM %" " * (30 - LOCAL)% 
RESETCOLOR

IF TARGET
	LOCAL = LIMIT(BASE:TARGET:興奮度 / 100,0,10)
	PRINTFORM 興奮度(%CALLNAME:TARGET%):
	SIF BASE:TARGET:興奮度 == MAXBASE:TARGET:興奮度
		SETCOLOR 255,51,153
	PRINTFORM %UNICODE(0x2665) * LOCAL% 
	RESETCOLOR

ENDIF
PRINTL 
LOCAL = MAX(BASE:MASTER:理性 / 100,1)
PRINTFORM   理性(%CALLNAME:MASTER%):
SIF BASE:MASTER:理性 < 100
	SETCOLOR 255,255,0
PRINTFORM %"★" * LOCAL%
PRINTFORM %" " * (30 - LOCAL * 2)% 
RESETCOLOR

IF TARGET
	LOCAL = MAX(BASE:TARGET:理性 / 100,1)
	PRINTFORM   理性(%CALLNAME:TARGET%):
	SIF BASE:TARGET:理性 < 100
		SETCOLOR 255,255,0
	PRINTFORM %"★" * LOCAL% 
	RESETCOLOR

ENDIF

PRINTL 
IF TCVAR:MASTER:イベント == 2
	;IF CFLAG:MASTER:受能動 == 2
		LOCAL = MAX(BASE:MASTER:反抗 / 100,1)
		PRINTFORM   反抗(%CALLNAME:MASTER%):
		SIF BASE:MASTER:反抗 == 0
			SETCOLOR 255,255,0
		;PRINTFORM %"★" * LOCAL%
		PRINTFORM %UNICODE(0x2715) * LOCAL%
		PRINTFORM %" " * (30 - LOCAL * 2)%
		RESETCOLOR

	;ELSE
	;	PRINTFORM %" " * (30 - LOCAL * 2)%
	;ENDIF

	;IF CFLAG:TARGET:受能動 == 2
		LOCAL = MAX(BASE:TARGET:反抗 / 100,1)
		PRINTFORM   反抗(%CALLNAME:TARGET%):
		SIF BASE:TARGET:反抗 == 0
			SETCOLOR 255,255,0
		;PRINTFORM %"★" * LOCAL%
		PRINTFORM %UNICODE(0x2715) * LOCAL%
		RESETCOLOR
	;ENDIF
	PRINTL 
ENDIF
PRINTFORM %BASENAME:0,6%(%CALLNAME:MASTER%)
BAR BASE:MASTER:体力 , MAXBASE:MASTER:体力 ,16
PRINTFORM ({BASE:MASTER:体力,5}/{MAXBASE:MASTER:体力,5})
IF TARGET
	PRINTFORM %BASENAME:0,6%(%CALLNAME:TARGET%)
	BAR BASE:TARGET:体力 , MAXBASE:TARGET:体力 ,16
	PRINTFORM ({BASE:TARGET:体力,5}/{MAXBASE:TARGET:体力,5})
ENDIF
PRINTL 

PRINTFORM %BASENAME:1,6%(%CALLNAME:MASTER%)
BAR BASE:MASTER:气力 , MAXBASE:MASTER:气力 ,16
PRINTFORM ({BASE:MASTER:气力,5}/{MAXBASE:MASTER:气力,5})
IF TARGET
	PRINTFORM %BASENAME:1,6%(%CALLNAME:TARGET%)
	BAR BASE:TARGET:气力 , MAXBASE:TARGET:气力 ,16
	PRINTFORM ({BASE:TARGET:气力,5}/{MAXBASE:TARGET:气力,5})
ENDIF

PRINTL 

;精力ゲージ
IF GETBIT(TALENT:MASTER:性別,1)
	PRINTFORM %BASENAME:6,6%(%CALLNAME:MASTER%)
	BAR BASE:MASTER:6 , MAXBASE:MASTER:6 ,16
	PRINTFORM ({BASE:MASTER:6,5}/{MAXBASE:MASTER:6,5})
ELSE
	PRINTFORM %" " * (LOCAL:1 + 39)%
ENDIF
IF TARGET && GETBIT(TALENT:TARGET:性別,1)
	PRINTFORM %BASENAME:6,6%(%CALLNAME:TARGET%)
	BAR BASE:TARGET:6 , MAXBASE:TARGET:6 ,16
	PRINTFORM ({BASE:TARGET:6,5}/{MAXBASE:TARGET:6,5})
ENDIF
PRINTL 


;勃起ゲージ
IF GETBIT(TALENT:MASTER:性別,1)
	PRINTFORM %BASENAME:5,6%(%CALLNAME:MASTER%)
	BAR BASE:MASTER:5 , MAXBASE:MASTER:5 ,16
	PRINTFORM ({BASE:MASTER:5,5}/{MAXBASE:MASTER:5,5})
ELSE
	PRINTFORM %" " * (LOCAL:1 + 39)%
ENDIF
IF TARGET && GETBIT(TALENT:TARGET:性別,1)
	PRINTFORM %BASENAME:5,6%(%CALLNAME:TARGET%)
	BAR BASE:TARGET:5 , MAXBASE:TARGET:5 ,16
	PRINTFORM ({BASE:TARGET:5,5}/{MAXBASE:TARGET:5,5})
ENDIF
PRINTL 

;射精槽
IF GETBIT(TALENT:MASTER:性別,1)
	PRINTFORM %BASENAME:2,6%(%CALLNAME:MASTER%)
	BAR BASE:MASTER:2 , MAXBASE:MASTER:2 ,16
	PRINTFORM ({BASE:MASTER:2,5}/{MAXBASE:MASTER:2,5})
ELSE
	PRINTFORM %" " * (LOCAL:1 + 39)%
ENDIF
IF TARGET && GETBIT(TALENT:TARGET:性別,1)
	PRINTFORM %BASENAME:2,6%(%CALLNAME:TARGET%)
	BAR BASE:TARGET:2 , MAXBASE:TARGET:2 ,16
	PRINTFORM ({BASE:TARGET:2,5}/{MAXBASE:TARGET:2,5})
ENDIF
PRINTL 

;母乳ゲージ
IF TALENT:MASTER:母乳体质
	;今のところは最大値を常にチェック
	;IF MAXBASE:MASTER:3 < 0
	;ENDIF
		MAXBASE:MASTER:3 = 10000
		IF TALENT:MASTER:淫乳
			MAXBASE:MASTER:3 /= 2
		ENDIF
	PRINTFORM %BASENAME:3,6%(%CALLNAME:MASTER%)
	BAR BASE:MASTER:3 , MAXBASE:MASTER:3 ,16
	PRINTFORM ({BASE:MASTER:3,5}/{MAXBASE:MASTER:3,5})
ELSE
	PRINTFORM %" " * (LOCAL:1 + 39)%
ENDIF
IF TARGET && TALENT:TARGET:母乳体质
	;今のところは最大値を常にチェック
	;IF MAXBASE:TARGET:3 < 0
		MAXBASE:TARGET:3 = 10000
		IF TALENT:TARGET:淫乳
			MAXBASE:TARGET:3 /= 2
		ENDIF
	;ENDIF
	PRINTFORM %BASENAME:3,6%(%CALLNAME:TARGET%)
	BAR BASE:TARGET:3 , MAXBASE:TARGET:3 ,16
	PRINTFORM ({BASE:TARGET:3,5}/{MAXBASE:TARGET:3,5})
ENDIF
PRINTL 



SIF CFLAG:MASTER:前回行動
PRINTFORML <前回行動:%TRAINNAME:(CFLAG:MASTER:前回行動)%>
SIF CFLAG:MASTER:前回被行動
PRINTFORML <前回行動:%TRAINNAME:(CFLAG:MASTER:前回被行動)%>
CALL SHOW_INFO_PALAM
PRINTL 

@WEEK(ARG)
#FUNCTIONS
SELECTCASE ARG % 7
	CASE 0
		RETURNF "日"
	CASE 1
		RETURNF "月"
	CASE 2
		RETURNF "火"
	CASE 3
		RETURNF "水"
	CASE 4
		RETURNF "木"
	CASE 5
		RETURNF "金"
	CASE 6
		RETURNF "土"
ENDSELECT

@TIME_NAME(ARG)
#FUNCTIONS
SELECTCASE TIME
	CASE 0
		RETURNF "朝"
	CASE 1
		RETURNF "放課後"
	CASE 2
		RETURNF "夜"
ENDSELECT

@NEXT_DAY
VARSET LOCAL
;次の日に進むときの処理
IF !HOLIDAY()
	SELECTCASE CFLAG:MASTER:出席
		CASE 0
			PRINTL 因为偷懒学校评价下降了･･････
			BASE:MASTER:評判 -= 100
			CFLAG:MASTER:欠席日数++
		CASE 1
			PRINTL 下午的课程偷懒，学校评价下降了･･････
			BASE:MASTER:評判 -= 30
		CASE 2
			PRINTL 上午的课程偷懒，学校评价下降了･･････
			BASE:MASTER:評判 -= 30
		CASE 3
			BASE:MASTER:評判 += 5
	ENDSELECT
ENDIF
FOR D,2,CHARANUM
	BASE:D:評判 += 1
NEXT

PRINTW 日期变了
;CFLAG:MASTER:現在位置 = 1
BASE:MASTER:学习成绩 -= 3
EQUIP:MASTER:可怕的便当 = 0
EQUIP:MASTER:普通的便当 = 0
EQUIP:MASTER:美味的便当 = 0
FOR LOCAL,1,CHARANUM
	CFLAG:LOCAL:食事 = 0
	CFLAG:LOCAL:出席 = 0
	CFLAG:LOCAL:痴漢発見 = 0
NEXT
DAY += 1
DAY:3 += 1
;;;TIME -= 1440
TIME = 0
;次の月になるときの処理
;;;悪いけど-29や-30や-12は1を代入に直させていただきます。
IF DAY:3 > 30
	CALL SHIHAI_SYUUKEI
ENDIF

SELECTCASE DAY:2
	CASE 2
		IF DAY:1 % 4 == 0 && DAY:3 > 29
;;;			DAY:3 -= 29
			DAY:3 = 1
			DAY:2++
			CFLAG:MASTER:お小遣い = 0
		ELSEIF DAY:3 > 28
;;;			DAY:3 -= 28
			DAY:3 = 1
			DAY:2++
			CFLAG:MASTER:お小遣い = 0
		ENDIF
	CASE 4,6,9,11
		IF DAY:3 > 30
;;;			DAY:3 -= 30
			DAY:3 = 1
			DAY:2++
			CFLAG:MASTER:お小遣い = 0
		ENDIF
	CASEELSE
		IF DAY:3 > 31
;;;			DAY:3 -= 31
			DAY:3 = 1
			DAY:2++
			CFLAG:MASTER:お小遣い = 0
		ENDIF
ENDSELECT

;次の年になるときの処理
IF DAY:2 > 12
;;;	DAY:2 -= 12
	DAY:2 = 1
	DAY:1 += 1
ENDIF
;;;ここに月集計を入れます
;IF DAY:3 == 1
;IF DAY:3 > 1
;	CALL SHIHAI_SYUUKEI
;ENDIF

D:101 = 0
TSTR:11 = 
D:101 = HOLIDAY()
SELECTCASE D:101
	CASE 2
		TSTR:11 = 春休み
	CASE 3
		TSTR:11 = 夏休み
	CASE 4
		TSTR:11 = 冬休み
	CASE 5
		TSTR:11 = 正月
	CASE 6
		TSTR:11 = 成人の日
	CASE 7
		TSTR:11 = 建国記念の日
	CASE 8
		TSTR:11 = 春分の日
	CASE 9
		TSTR:11 = 昭和の日
	CASE 10
		TSTR:11 = 憲法記念日
	CASE 11
		TSTR:11 = みどりの日
	CASE 12
		TSTR:11 = こどもの日
	CASE 13
		TSTR:11 = 海の日
	CASE 14
		TSTR:11 = 敬老の日
	CASE 15
		TSTR:11 = 秋分の日
	CASE 16
		TSTR:11 = 体育の日
	CASE 17
		TSTR:11 = 文化の日
	CASE 18
		TSTR:11 = 勤労感謝の日
	CASE 19
		TSTR:11 = 天皇诞生日
	CASE 20
		TSTR:11 = 克里斯マスイブ
ENDSELECT
SIF FLAG:お弁当 == 1
	CALL BENTO


