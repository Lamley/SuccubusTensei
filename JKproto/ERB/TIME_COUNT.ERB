@TIME_COUNT(ARG)
VARSET LOCAL
TIME += ARG
TFLAG:経過時間 = 0
SIF TIME > 1440
	CALL NEXT_DAY
FOR LOCAL,1,CHARANUM
	BASE:LOCAL:精力 = MIN(BASE:LOCAL:精力 + (ABL:LOCAL:欲望 + 1) * ARG * (TALENT:LOCAL:绝伦 * 2 + 1),MAXBASE:LOCAL:精力)
	BASE:LOCAL:性欲 = MIN(BASE:LOCAL:性欲 + (ABL:LOCAL:欲望 + 1) * ARG * 2 * BASE:LOCAL:精力 / MAXBASE:LOCAL:精力,MAXBASE:LOCAL:性欲)
	SELECTCASE BASE:LOCAL:性欲 * 100 / MAXBASE:LOCAL:性欲
		CASE IS <= 30
			BASE:LOCAL:興奮度 = MAX(BASE:LOCAL:興奮度 - (ARG * (10 - BASE:LOCAL:性欲 * 10 / MAXBASE:LOCAL:性欲)) / 2 ,0)
		CASE IS >= 70
			BASE:LOCAL:興奮度 = MIN(BASE:LOCAL:興奮度 + (ARG * BASE:LOCAL:性欲 / 7000) ,BASE:LOCAL:性欲 / 10)
	ENDSELECT
	BASE:LOCAL:理性 = LIMIT(BASE:LOCAL:理性 + ARG * (MAXBASE:LOCAL:興奮度 - BASE:LOCAL:興奮度) / 15,0,MAXBASE:LOCAL:理性)
	IF CFLAG:LOCAL:衰弱 || CFLAG:LOCAL:睡眠
		BASE:LOCAL:体力 = LIMIT(BASE:LOCAL:体力 + ARG * 3 * (MAXBASE:LOCAL:疲労 - BASE:LOCAL:疲労) / MAXBASE:LOCAL:疲労 ,0,MAXBASE:LOCAL:体力)
		BASE:LOCAL:气力 = LIMIT(BASE:LOCAL:气力 + ARG * 3 * (MAXBASE:LOCAL:ストレス - BASE:LOCAL:ストレス) / MAXBASE:LOCAL:ストレス ,0,MAXBASE:LOCAL:气力)
		BASE:LOCAL:疲労 = LIMIT(BASE:LOCAL:疲労 - ARG ,0,MAXBASE:LOCAL:疲労)
		BASE:LOCAL:ストレス = LIMIT(BASE:LOCAL:ストレス - ARG ,0,MAXBASE:LOCAL:ストレス)
		BASE:LOCAL:眠気 = LIMIT(BASE:LOCAL:眠気 - ARG * 2 ,0,MAXBASE:LOCAL:眠気)
	ELSE
		BASE:LOCAL:眠気 = LIMIT(BASE:LOCAL:眠気 + ARG ,0,MAXBASE:LOCAL:眠気)
		SELECTCASE BASE:LOCAL:眠気
			CASE IS >= 1600
				BASE:LOCAL:体力 = LIMIT(BASE:LOCAL:体力 - ARG * 2,0 ,MAXBASE:LOCAL:体力)
				BASE:LOCAL:气力 = LIMIT(BASE:LOCAL:气力 - ARG * 2,0 ,MAXBASE:LOCAL:气力)
				BASE:LOCAL:疲労 = LIMIT(BASE:LOCAL:疲労 + ARG * 2,0,MAXBASE:LOCAL:疲労)
				BASE:LOCAL:ストレス = LIMIT(BASE:LOCAL:ストレス + ARG ,0,MAXBASE:LOCAL:ストレス)
			CASE IS >= 1000
				BASE:LOCAL:气力 = LIMIT(BASE:LOCAL:气力 - ARG ,0 ,MAXBASE:LOCAL:气力)
				BASE:LOCAL:疲労 = LIMIT(BASE:LOCAL:疲労 + ARG ,0,MAXBASE:LOCAL:疲労)
		ENDSELECT

	ENDIF
	
	IF GETBIT(TALENT:LOCAL:2,1)
		SIF BASE:LOCAL:精力 * 10 > MAXBASE:LOCAL:精力 * 8 && BASE:LOCAL:勃起 < MAXBASE:LOCAL:勃起 / 2
			BASE:LOCAL:勃起 = MIN(BASE:LOCAL:勃起 + (ABL:LOCAL:欲望 + 1) * ARG * (TALENT:LOCAL:绝伦 * 2 + 1),MAXBASE:LOCAL:勃起 / 2)
		SIF BASE:LOCAL:精力 * 10 < MAXBASE:LOCAL:精力 * 3
			BASE:LOCAL:勃起 = MAX(BASE:LOCAL:勃起 - ARG * 100,0)
		BASE:LOCAL:射精 = MAX(BASE:LOCAL:射精 - ARG * (10 - BASE:LOCAL:性欲 * 10 / MAXBASE:LOCAL:性欲),0)
	ENDIF
	SIF !TCVAR:LOCAL:イベント
		BASE:LOCAL:反抗 = LIMIT(BASE:LOCAL:反抗 + ARG * 10 ,0,MAXBASE:LOCAL:反抗)
	CFLAG:LOCAL:待機時間 = MAX(CFLAG:LOCAL:待機時間 - ARG,0)
	TCVAR:LOCAL:会话累積値 = MAX(0,TCVAR:LOCAL:会话累積値 - ARG)
NEXT
